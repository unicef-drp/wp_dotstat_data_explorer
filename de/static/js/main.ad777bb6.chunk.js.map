{"version":3,"sources":["web/i18n/provider.js","web/i18n/index.js","web/ducks/app.js","web/lib/settings.js","web/lib/sdmx/annotations.js","web/lib/sdmx/structure.js","web/lib/sdmx/index.js","web/lib/utils/index.js","web/selectors/vis.js","web/selectors/sdmx.js","web/ducks/vis.js","web/selectors/app.js","web/api/formatMapper.js","web/api/sdmx.js","web/ducks/sdmx.js","web/core/reducer.js","web/core/middlewares.js","web/core/store.js","web/theme/theme.js","web/theme/index.js","web/components/Error.js","web/hocs/withResponsiveness.js","web/components/FilterPeriod/index.js","web/components/FilterSelection/index.js","web/components/Filters/index.js","web/lib/layout/index.js","web/selectors/table.js","web/components/TableConfig/TableConfig.js","web/components/TableConfig/index.js","web/components/Toolbar/menus.js","web/components/Toolbar/actions.js","web/components/Toolbar/index.js","web/components/Tools/Tools.js","web/components/Tools/index.js","web/components/Table/Cell.js","web/components/ToolbarUnicef/menus.js","web/components/ToolbarUnicef/actions.js","web/components/ToolbarUnicef/index.js","web/components/Table/Table.js","web/components/Table/index.js","web/components/Chart/index.js","web/components/Viewer/config.js","web/components/Viewer/index.js","web/components/Footnotes/Footnotes.js","web/components/Footnotes/index.js","web/components/Main/Main.js","web/components/Main/index.js","web/components/App/App.js","web/components/App/index.js","web/index.js","web/assets/data-explorer-logo.png"],"names":["Provider","_ref","localeId","messages","children","react_default","a","createElement","index_es","locale","key","React","Children","only","model","concat","setPending","id","is","type","payload","sdmx","R","window","SETTINGS","getDatasource","sdmxRange","sdmxPeriod","sdmxPeriodBoundaries","sdmxPeriodBoundariesMinMax","min","max","getSdmxAttribute","Array","chart","chartOptions","isValidNumber","Number","NaN","getIsSelected","index","annotations","selection","Boolean","md5","sdmx_structure","structure","lang","dimensions","conceptSchemes","dataflow","codelists","getCodelists","getLocalisedName","getDataflow","agencyID","rest","Object","objectWithoutProperties","objectSpread","code","agencyId","name","acc","dimension","getConceptIdentity","conceptIdentity","getUrnToParse","conceptIdentityUrnToParse","conceptIdentityRepresentationCode","conceptScheme","_ref2","version","getSdmxId","sdmxId","getConceptScheme","getConcepts","concepts","getConcept","concept","getId","getLocalRepresentation","localRepresentation","getCodeList","_ref3","codes","getSortedCodes","parsedDimension","roles","conceptRoles","values","_ref4","parent","_ref4$annotations","parentId","isDefaultSelected","label","localisedCodes","toConsumableArray","getConfig","configArgs","Error","_R$prop2","datasourceId","dataflowId","datasource","isStructure","keyword","identifiers","dataquery","url","getDataUrl","requestArgs","period","params","qs","stringify","startPeriod","endPeriod","addQueryPrefix","getFilename","greaterThanOne","getDimensionsIds","d","rules","isTimeDimension","getUniq","array1","array2","withIndex","keysMap","obj","value","dimensionFormats","dimensionValueDisplay","both","getVis","getPeriod","createSelector","getViewer","getAction","getDisplay","getFilter","getDataquery","getIsFullscreen","getTimeDimensionInverted","getLayout","getDimensionGetter","getDimensionFormat","getSdmx","getDimensions","getData","getVisDataquery","getCustomAttributes","data","format","flagsSet","Set","attrs","memo","rattr","attr","isFootnote","has","flags","footnotes","getFilters","filters","filter","valueIdsSet","getSelection","changeViewer","viewerId","changeAction","actionId","changeDataflow","changeDataquery","filterId","valueId","dispatch","getState","getApp","getLocale","getPending","getIsPending","getIsRtl","convertName","names","ret","forEach","v","renameKey","object","oldKey","newKey","createLinkNode","rel","urn","convertLanguageNode","text","convert_struct_component","comp","cl","convertCodelist","methods","getStructure","_R$prop","getFusionConfig","qStringParams","references","detail","includeMetrics","acceptParam","Accept-Language","Accept","sdmxMapperStruct","s","meta","content-languages","schema","dataflows","Dataflow","dataStructureRef","links","ConceptScheme","Codelist","hasUniqueRoot","noParentCount","i","length","parentCode","isUniqueRoot","c","dataStructures","DataStructure","dataStructureComponents","dimensionList","pos","timePos","position","representation","enumeration","timeDimensions","textFormat","textType","isSequence","isMultiLingual","splice","measureList","primaryMeasure","attributeList","attributes","mandatory","assignmentStatus","attributeRelationship","dimensionReferences","fm","axios","get","headers","then","structureParser","_getConfig","sdmxMapperData","header","dataSets","observations","k","description","dataSet","dataset","series","observation","hasOwnProperty","isNaN","parseFloat","dimensionAtObservation","v8Transformer","getDataFile","responseType","response","blob","Blob","FileSaver","saveAs","main","_ref5","method","error","_ref6","_ref7","slicedToArray","fn","request","ctx","pendingId","sdmxApi","res","catch","log","errorCode","statusCode","status","pushLog","requestData","shouldRequestStructure","arguments","undefined","Promise","resolve","requestStructure","layout","document","getElementById","dispatchEvent","CustomEvent","requestDataFile","isDownloadAllData","combineReducers","app","state","action","vis","isFullscreen","timeDimensionInverted","isTimeDimensionInverted","filterIndex","safeDataquery","requestDataMiddleware","next","future","withLogger","middlewares","Colors","Formats","theme","rtl","createMuiTheme","overrides","MuiButton","textTransform","palette","primary","mainAlpha","light","dark","contrastText","secondary","hover","selected","active","typography","fontFamily","raisedButton","textColor","primaryTextColor","default","backgroundColor","configLabelBG","configLabelCol","appSize","appMinSize","itemMinSize","scopeListContainer","maxHeight","scopeList","divider","direction","useNextVariants","configLabel","color","fontSize","configButtonRegular","fontWeight","configButtonSelected","panelSummary","panelIcon","configInputs","alert","table","yBg","yBgHover","yBgActive","yFontHeader","yFont","zBg","zBgHover","zBgActive","zFontHeader","zFont","xBg","xBgHeader","xBgHover","xBgActive","xFontHeader","xFont","oFont","sBg","jss","create","plugins","jssPreset","generateClassName","createGenerateClassName","isRtl","JssProvider_default","styles","muiTheme","glamorous_esm","mergeDeepRight","mainTheme","ErrorBoundary","props","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","hasError","setState","isFinal","build","isHome","title","logo","Component","Narrow","react_responsive_default","assign","query","Default","compose","connect","createStructuredSelector","changePeriod","withProps","titleLabel","tagLabel","periodBoundaries","options","labelStepSize","pure","DEFilterPeriod","items","changeFilters","clearAllLabel","blankLabel","noScroll","VXFiltersCurrent","Filter","VXScopeList","injectIntl","activePanelId","changeSelection","onChangeActivePanel","intl","optionsSpotlight","hasClearAll","mainPlaceholder","formatMessage","secondaryPlaceholder","spotlight","engine","spotlightScopeListEngine","placeholder","fields","vx.spotlight.field.label","accessor","isSelected","topElementComponent","VXSpotlight","parentProps","TopElementComponent","defaultConcat","getValuesFlat","adjustment","notAvailableIds","withoutNotAvailableIds","pivot","defineProperty","prop","isInvalid","dimensionIds","layoutIds","hasInvalidIds","getDefaultLayout","many","getMissingIds","defaultLayout","ids","timeId","areaId","isAreaDimension","helper","omitIds","pickId","x","y","z","rows","sections","defaultLayoutBuilder","defaultMissingIds","getDataDimensions","getVisDataDimensions","one","getTableConfigDimensions","isOne","Layout","isTimePeriod","getVisTableConfigLayout","getVisLayout","structureDimensions","dataDimensions","Sdmx","visLayout","sdmxLayout","dimensionsIds","oneIds","missingIds","TableConfig","tableProps","noCollapse","dimensionGetter","changeLayout","changeGetter","changeIsTimeDimensionInverted","isNarrow","noPreview","labels","commit","cancel","row","column","section","o","time","asc","desc","help","dimensionGetters","menus","Toolbar_actions","changeActionId","actions","icon","filtersBtn","isDownloading","changeMenu","loadingActionId","selectedMenuId","selectedActionId","showLabel","DEVisualisationToolbar","Tools","isFilters","Fragment","Toolbar","isFull","isOpen","noHeader","FilterSelection","FilterPeriod","Filters","components_TableConfig","isChartConfig","StyledCell","glamorous","div","width","height","padding","textAlign","isYLast","isXLast","borderTop","border","borderLeft","borderRight","borderBottom","Cell","renderObservation","variant","ToolbarUnicef_menus","ToolbarUnicef_actions","TableContainer","borderLeftWidth","borderRightWidth","marginTop","overflowX","Table","viewerConfig","itemFormatter","isNotATable","className","dotstatsuite_ui_header_lib_default","fonts","ToolbarUnicef","Table_Cell","dotstatsuite_ui_footer_lib_default","footer","source","footer_visible","link","sourceLabel","DETableCell","customAttributes","idsNotInMany","getTableData","mapProps","chartData","observationGetter","config","Chart","owner","subtitle","uprs","tooltip","axisLegend","chartLegend","copyright","branch","renderComponent","message","Footnotes","List_default","dense","ListItem_default","ListItemText_default","Main","enhancedData","isLoadingData","display","formaterIds","dataUrl","dotstatsuite_components_lib","sdmxUrl","location","href","render","properties","loadingLabel","isLarge","Viewer","components_Footnotes","decimals","prefscale","App","isLoadingStructure","components_Main","_React$Component","_temp","_getPrototypeOf2","_len","args","_key","apply","react","withResponsiveness_Narrow","withResponsiveness_Default","inherits","renderNothing","ES6_Error","console","info","_ref$locales","locales","_ref$localeId","addLocaleData","enLocaleData","numeral","delimiters","register","initializeI18n","i18n","store","initialState","rootReducer","thunk","enhancers","applyMiddleware","createStore","logs","pending","viewer","reducer","DATAFLOW","ROOT","addEventListener","event","components_Error","es","web_theme","provider","I18N","components_App","module","exports","__webpack_require__","p"],"mappings":"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","file":"static/js/main.ad777bb6.chunk.js","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { IntlProvider } from 'react-intl';\r\n\r\nconst Provider = ({ localeId, messages, children }) => (\r\n  <IntlProvider locale={localeId} key={localeId} messages={messages[localeId]}>\r\n    {React.Children.only(children)}\r\n  </IntlProvider>\r\n);\r\n\r\nProvider.propTypes = {\r\n  localeId: PropTypes.string,\r\n  messages: PropTypes.object,\r\n  children: PropTypes.element.isRequired,\r\n};\r\n\r\nexport default Provider;\r\n","import numeral from 'numeral';\r\nimport * as R from 'ramda';\r\nimport { addLocaleData } from 'react-intl';\r\nimport enLocaleData from 'react-intl/locale-data/en';\r\n\r\nconst model = locale => `${locale}/${locale}`;\r\n\r\nexport const setLocale = locale => numeral.locale(model(locale));\r\n\r\nexport const initialize = ({ locales = [], localeId = 'en' }) => {\r\n  addLocaleData(enLocaleData);\r\n\r\n  setLocale(localeId);\r\n\r\n  R.forEach(locale => {\r\n    const delimiters = R.prop('delimiters')(locale);\r\n    if (R.isNil(delimiters)) return;\r\n    numeral.register('locale', model(R.prop('id')(locale)), { delimiters });\r\n  }, R.values(locales));\r\n};\r\n\r\nexport { default as I18nProvider } from './provider';\r\n","import * as R from 'ramda';\r\n\r\n//-----------------------------------------------------------------------------------------constants\r\nexport const LOG_ERROR = '@@app/LOG_ERROR';\r\nexport const PUSH_LOG = '@@app/PUSH_LOG';\r\nexport const SET_PENDING = '@@app/SET_PENDING';\r\n\r\n//------------------------------------------------------------------------------------------creators\r\nexport const pushLog = log => ({ type: PUSH_LOG, payload: { log } });\r\nexport const setPending = (id, is) => ({ type: SET_PENDING, payload: { id, is } });\r\n\r\n//-------------------------------------------------------------------------------------------reducer\r\nexport default (state = {}, action = {}) => {\r\n  switch (action.type) {\r\n    case PUSH_LOG:\r\n      return R.over(R.lensProp('logs'), R.prepend(action.payload.log), state);\r\n    case SET_PENDING:\r\n      return R.assocPath(['pending', action.payload.id], action.payload.is, state);\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import * as R from 'ramda';\r\n\r\nexport const sdmx = R.propOr({}, 'sdmx', window.SETTINGS);\r\nexport const getDatasource = R.flip(R.prop)(R.prop('datasources', sdmx));\r\nexport const sdmxRange = R.prop('range', sdmx);\r\nexport const sdmxPeriod = R.path(['period', 'default'], sdmx);\r\nexport const sdmxPeriodBoundaries = R.pathOr([], ['period', 'boundaries'], sdmx);\r\nexport const sdmxPeriodBoundariesMinMax = {\r\n  min: R.head(sdmxPeriodBoundaries),\r\n  max: R.last(sdmxPeriodBoundaries),\r\n};\r\nexport const getSdmxAttribute = id =>\r\n  R.pipe(R.pathOr([], ['attributes', id]), R.ifElse(R.is(Array), R.identity, R.flip(R.append)([])))(\r\n    sdmx,\r\n  );\r\nexport const chart = R.propOr({}, 'chart', window.SETTINGS);\r\nexport const chartOptions = R.prop('options', chart);\r\n","import * as R from 'ramda';\r\nimport md5 from 'md5';\r\n\r\nconst isValidNumber = R.both(R.is(Number), R.complement(R.equals(NaN)));\r\n\r\nexport const getIsSelected = ({ index, id, annotations, selection }) => {\r\n  if (R.or(R.isEmpty(selection), R.isNil(selection))) {\r\n    return R.ifElse(R.isEmpty, R.F, R.pipe(R.find(R.propEq('type', 'DEFAULT')), Boolean))(\r\n      annotations,\r\n    );\r\n  }\r\n  return !!R.prop(md5(`${index}${id}`))(selection);\r\n};\r\n\r\nexport const getSortedCodes = lang =>\r\n  R.sortBy(\r\n    R.pipe(\r\n      R.propOr([], 'annotations'),\r\n      R.find(R.propEq('type', 'ORDER')),\r\n      R.prop('text'),\r\n      R.propOr(0, lang),\r\n      Number,\r\n      R.ifElse(isValidNumber, R.identity, R.always(0)),\r\n    ),\r\n  );\r\n","import * as R from 'ramda';\r\nimport { getIsSelected, getSortedCodes } from './annotations';\r\n\r\nexport default structure => {\r\n  const lang = R.pipe(R.pathOr([], ['meta', 'content-languages']), R.head)(structure);\r\n  const dimensions = R.pipe(\r\n    R.pathOr([], ['data', 'dataStructures']),\r\n    R.head,\r\n    R.pathOr([], ['dataStructureComponents', 'dimensionList', 'dimensions']),\r\n  )(structure);\r\n  const conceptSchemes = R.pathOr([], ['data', 'conceptSchemes'])(structure);\r\n\r\n  if (R.any(R.anyPass([R.isNil, R.isEmpty]))([lang, dimensions, conceptSchemes])) {\r\n    return { dimensions: [], dataflow: {} };\r\n  }\r\n\r\n  const getCodelists = R.pathOr([], ['data', 'codelists']);\r\n  const codelists = getCodelists(structure);\r\n\r\n  const getLocalisedName = id =>\r\n    R.pipe(R.pathOr('', ['name', lang]), R.ifElse(R.isEmpty, R.always(`[${id}]`), R.identity));\r\n\r\n  const getDataflow = R.pipe(\r\n    R.pathOr([], ['data', 'dataflows']),\r\n    R.head,\r\n    R.pick(['id', 'version', 'agencyID', 'name']),\r\n    ({ id, agencyID, ...rest }) => ({\r\n      ...rest,\r\n      code: id,\r\n      agencyId: agencyID,\r\n      name: getLocalisedName(id)(rest),\r\n    }),\r\n  );\r\n  const filters = R.addIndex(R.reduce)(\r\n    (acc, dimension, index) => {\r\n      const getConceptIdentity = R.propOr(null, 'conceptIdentity');\r\n      if (R.isNil(getConceptIdentity(dimension))) return acc;\r\n      const conceptIdentity = getConceptIdentity(dimension);\r\n\r\n      const getUrnToParse = R.match(/[^urn:sdmx:org.sdmx.infomodel][^.|=]+/g);\r\n      if (R.isEmpty(getUrnToParse(conceptIdentity))) return acc;\r\n      const conceptIdentityUrnToParse = getUrnToParse(conceptIdentity);\r\n      const conceptIdentityRepresentationCode = R.last(conceptIdentityUrnToParse);\r\n\r\n      const getConceptScheme = R.find(({ agencyID, id, version }) => {\r\n        const getSdmxId = R.match(/=(.*\\))/);\r\n        const sdmxId = R.tail(R.head(getSdmxId(conceptIdentity)));\r\n        const sdmxIdRecomposed = `${agencyID}:${id}(${version})`;\r\n        return sdmxIdRecomposed === sdmxId;\r\n      });\r\n      const conceptScheme = getConceptScheme(conceptSchemes);\r\n      const getConcepts = R.propOr(null, 'concepts');\r\n      if (R.isNil(getConcepts(conceptScheme))) return acc;\r\n      const concepts = getConcepts(conceptScheme);\r\n\r\n      const getConcept = R.find(R.propEq('id', conceptIdentityRepresentationCode));\r\n      if (R.isNil(getConcept(concepts))) return acc;\r\n      const concept = getConcept(concepts);\r\n\r\n      const getId = R.propOr(null, 'id');\r\n      if (R.isNil(getId(dimension))) return acc;\r\n      const id = getId(dimension);\r\n\r\n      // ---------------------------------------------------------------------------------------------\r\n      //                                  values [ ]\r\n      // ---------------------------------------------------------------------------------------------\r\n\r\n      const getLocalRepresentation = R.pathOr(null, ['localRepresentation', 'enumeration']);\r\n      if (R.isNil(getLocalRepresentation(dimension))) return [];\r\n\r\n      const localRepresentation = getLocalRepresentation(dimension);\r\n\r\n      const type = R.nth(1)(getUrnToParse(localRepresentation));\r\n\r\n      const getCodeList = R.find(({ agencyID, id, version }) => {\r\n        const getSdmxId = R.match(/=(.*\\))/);\r\n        const sdmxId = R.tail(R.head(getSdmxId(localRepresentation)));\r\n        const sdmxIdRecomposed = `${agencyID}:${id}(${version})`;\r\n        return sdmxIdRecomposed === sdmxId && type === 'Codelist';\r\n      });\r\n\r\n      if (R.isEmpty(codelists) || R.isEmpty(R.propOr([], 'codes')(getCodeList(codelists)))) {\r\n        return acc;\r\n      }\r\n      const codes = getSortedCodes(lang)(R.propOr([], 'codes')(getCodeList(codelists)));\r\n\r\n      const localisedCodes = index =>\r\n        R.map(({ id, parent, name, annotations = [] }) => ({\r\n          id,\r\n          parentId: parent,\r\n          isDefaultSelected: getIsSelected({ index, id, annotations }),\r\n          //isDefaultSelected: id === 'DSB_STATUS_TOTAL' || id === 'SEX_T',\r\n          label: getLocalisedName(id)({ name }),\r\n        }));\r\n\r\n      const parsedDimension = {\r\n        id,\r\n        index,\r\n        roles: !R.isNil(dimension.conceptRoles) ? dimension.conceptRoles : [],\r\n        values: localisedCodes(index)(codes),\r\n      };\r\n\r\n      return [\r\n        ...acc,\r\n        {\r\n          ...parsedDimension,\r\n          label: getLocalisedName(parsedDimension.id)(concept),\r\n        },\r\n      ];\r\n    },\r\n    [],\r\n    dimensions,\r\n  );\r\n  return { dimensions: filters, dataflow: getDataflow(structure) };\r\n};\r\n","import * as R from 'ramda';\r\nimport qs from 'qs';\r\nimport { getDatasource } from '../settings';\r\nimport { rules } from '@sis-cc/dotstatsuite-components';\r\nexport { default as structureParser } from './structure';\r\n\r\nexport const getFusionConfig = ({ configArgs }) => {\r\n  const { datasourceId, dataflowId, agencyId, version } = R.prop('dataflow', configArgs);\r\n\r\n  const datasource = getDatasource(datasourceId);\r\n  if (R.isNil(datasource)) throw new Error(`Datasource undefined: datasourceId=${datasourceId}`);\r\n\r\n  const identifiers = R.join(',', [agencyId, dataflowId, R.defaultTo('latest', version)]);\r\n  return {\r\n    url: `${R.prop('url', datasource)}/availableconstraint/${identifiers}`,\r\n    datasource,\r\n  };\r\n};\r\n\r\nexport const getConfig = ({ type }) => ({ configArgs }) => {\r\n  if (R.not(R.includes(type, ['structure', 'data']))) throw new Error(`Invalid type: type=${type}`);\r\n\r\n  const { datasourceId, dataflowId, agencyId, version } = R.prop('dataflow', configArgs);\r\n\r\n  const datasource = getDatasource(datasourceId);\r\n  if (R.isNil(datasource)) throw new Error(`Datasource undefined: datasourceId=${datasourceId}`);\r\n\r\n  const isStructure = R.equals(type, 'structure');\r\n\r\n  const keyword = isStructure ? 'dataflow' : 'data';\r\n\r\n  const identifiers = R.join(isStructure ? '/' : ',', [\r\n    agencyId,\r\n    dataflowId,\r\n    R.defaultTo('latest', version),\r\n  ]);\r\n\r\n  const dataquery = isStructure ? '' : `/${R.defaultTo('all', R.prop('dataquery', configArgs))}`;\r\n\r\n  return {\r\n    url: `${R.prop('url', datasource)}/${keyword}/${identifiers}${dataquery}`,\r\n    datasource,\r\n  };\r\n};\r\n\r\nexport const getDataUrl = ({ configArgs, requestArgs }) => {\r\n  const period = R.prop('period', requestArgs);\r\n  const url = R.prop('url', getConfig({ type: 'data' })({ configArgs }));\r\n  const params = qs.stringify(\r\n    { startPeriod: R.head(period), endPeriod: R.last(period) },\r\n    { addQueryPrefix: true },\r\n  );\r\n\r\n  return `${url}${params}`;\r\n};\r\n\r\nexport const getFilename = R.pipe(\r\n  R.converge(R.append, [\r\n    R.pipe(R.prop('dataquery'), R.ifElse(R.isNil, R.always('all'), R.identity)),\r\n    R.pipe(\r\n      R.prop('dataflow'),\r\n      R.pick(['datasourceId', 'dataflowId', 'agencyId', 'version']),\r\n      R.values,\r\n    ),\r\n  ]),\r\n  R.join('_'),\r\n);\r\n\r\nexport const updateDataquery = dimensions => (filterId, valueId) => dataquery => {\r\n  // undefined filterId <=> no selection\r\n  if (R.isNil(filterId)) return R.reduce(R.concat('.'), '', dimensions);\r\n\r\n  const filterIndex = R.findIndex(R.propEq('id', filterId), dimensions);\r\n\r\n  const safeDataquery = R.isNil(dataquery) ? R.reduce(R.concat('.'), '', dimensions) : dataquery;\r\n\r\n  // undefined valueId <=> remove filter from selection\r\n  if (R.isNil(valueId)) {\r\n    return R.pipe(R.split('.'), R.update(filterIndex, ''), R.join('.'))(safeDataquery);\r\n  }\r\n\r\n  return R.pipe(\r\n    R.split('.'),\r\n    R.over(\r\n      R.lensIndex(filterIndex),\r\n      R.pipe(\r\n        R.ifElse(R.isEmpty, R.always([]), R.split('+')),\r\n        R.ifElse(R.includes(valueId), R.without([valueId]), R.append(valueId)),\r\n        R.join('+'),\r\n      ),\r\n    ),\r\n    R.join('.'),\r\n  )(safeDataquery);\r\n};\r\n\r\nconst greaterThanOne = R.pipe(R.length, R.flip(R.gt)(1));\r\nconst isMany = d =>\r\n  R.or(rules.isTimeDimension(R.prop('id')(d)), greaterThanOne(R.prop('values')(d)));\r\nexport const getDimensionsIds = R.pipe(R.filter(isMany), R.map(R.prop('id')));\r\nexport const getUniq = (array1, array2) => R.pipe(R.concat(array2), R.uniq)(array1);\r\n","import React from 'react';\r\nimport * as R from 'ramda';\r\nimport { rules } from '@sis-cc/dotstatsuite-components';\r\nimport numeral from 'numeral';\r\nimport { DETableCell } from '@sis-cc/dotstatsuite-ui-components';\r\n\r\nexport const renameKeys = R.curry((keysMap, obj) =>\r\n  R.reduce((acc, key) => R.assoc(keysMap[key] || key, obj[key], acc), {}, R.keys(obj)),\r\n);\r\n\r\nexport const isValidNumber = R.both(R.is(Number), R.complement(R.equals(NaN)));\r\nexport const withIndex = R.addIndex(R.map)((value, index) => R.assoc('index', index)(value));\r\n\r\nexport const observationGetter = ({\r\n  observations,\r\n  dimensions,\r\n  customAttributes,\r\n  isRtl,\r\n}) => () => coordinates => {\r\n  const isUncoded = R.anyPass([\r\n    R.prop('isFootnote'),\r\n    () => R.equals(R.prop('name'), R.prop('id')),\r\n    R.pipe(R.prop('id'), R.length, R.lte(4)),\r\n  ]);\r\n\r\n  const cellProps = isRtl => (value, valueFlags) => {\r\n    const [uncodedFlags, codedFlags] = R.partition(isUncoded)(valueFlags);\r\n    return { isRtl, value, codedFlags, uncodedFlags };\r\n  };\r\n\r\n  const getValueId = valueIndexes =>\r\n    R.pipe(\r\n      R.converge(R.prop, [R.pipe(R.prop('index'), R.nth(R.__, valueIndexes)), R.prop('values')]),\r\n      R.prop('id'),\r\n    );\r\n\r\n  const formatDecimal = ({ customAttributes, valueIndexes }) => {\r\n    const attr = R.prop('decimals', customAttributes);\r\n\r\n    if (R.isNil(attr)) return R.identity;\r\n\r\n    const d = Number(getValueId(valueIndexes)(attr));\r\n    if (R.complement(isValidNumber)(d)) return R.identity;\r\n    const format = R.equals(d, 0) ? '0' : `0,0.[${R.join('', R.times(R.always('0'), d))}]`;\r\n\r\n    return value => numeral(value).format(format);\r\n  };\r\n\r\n  const formatScale = ({ customAttributes, valueIndexes }) => {\r\n    const attr = R.prop('prefscale', customAttributes);\r\n    if (R.isNil(attr)) return R.identity;\r\n\r\n    const e = Number(getValueId(valueIndexes)(attr));\r\n    if (R.complement(isValidNumber)(e)) return R.identity;\r\n\r\n    return value => numeral(value).multiply(Math.pow(10, -1 * e));\r\n  };\r\n\r\n  const formatSeparator = value => {\r\n    if (isValidNumber(value)) return numeral(value).format(`0,0.[0000000]`);\r\n    return R.identity(value);\r\n  };\r\n\r\n  const getValue = customAttributes => values => {\r\n    const valueIndexes = R.tail(values);\r\n\r\n    return R.ifElse(\r\n      isValidNumber,\r\n      R.pipe(\r\n        formatScale({ customAttributes, valueIndexes }),\r\n        formatDecimal({ customAttributes, valueIndexes }),\r\n        formatSeparator,\r\n      ),\r\n      R.always('-'),\r\n    )(R.nth(0)(values));\r\n  };\r\n\r\n  const getValueFlags = attributeFlags =>\r\n    R.addIndex(R.reduce)((acc, valueIndex, attributeIndex) => {\r\n      if (R.isNil(valueIndex)) return acc;\r\n      const flag = R.prop(attributeIndex)(attributeFlags);\r\n      if (R.isNil(flag)) return acc;\r\n      return R.append(\r\n        R.pipe(\r\n          R.prop('values'),\r\n          R.nth(valueIndex),\r\n          R.assoc('isFootnote')(R.prop('isFootnote')(flag)),\r\n        )(flag),\r\n      )(acc);\r\n    }, []);\r\n\r\n  const observation = R.pipe(\r\n    R.toPairs,\r\n    R.sortBy(\r\n      R.pipe(R.prop(0), R.flip(R.prop)({ ...dimensions.many, ...dimensions.one }), R.prop('index')),\r\n    ),\r\n    R.pluck(1),\r\n    R.join(':'),\r\n    R.flip(R.propOr([]))(observations),\r\n    R.converge(cellProps(isRtl), [\r\n      getValue(customAttributes),\r\n      R.pipe(R.tail, getValueFlags(R.prop('flags')(customAttributes))),\r\n    ]),\r\n  )({\r\n    ...coordinates,\r\n    ...R.reduce((memo, { id }) => ({ ...memo, [id]: 0 }), {})(R.values(dimensions.one)),\r\n  });\r\n\r\n  return <DETableCell {...observation} />;\r\n};\r\n\r\nexport const observationFormat = ({ isRtl }) => ({ observations, dimensions, customAttributes }) =>\r\n  observationGetter({\r\n    dimensions,\r\n    observations,\r\n    customAttributes,\r\n    isRtl,\r\n  })(R.identity);\r\n\r\nexport const dimensionFormats = {\r\n  label: rules.dimensionValueDisplay('label'),\r\n  code: rules.dimensionValueDisplay('code'),\r\n  both: rules.dimensionValueDisplay('both'),\r\n};\r\n\r\nexport const getDimensionGetters = intl =>\r\n  R.reduce(\r\n    (memo, key) => ({\r\n      ...memo,\r\n      [key]: intl.formatMessage({ id: `vx.config.display.${key}` }),\r\n    }),\r\n    {},\r\n    R.keys(dimensionFormats),\r\n  );\r\n\r\nexport const makeTree = items => {\r\n  const hierarchy = R.reduce(\r\n    (index, item) =>\r\n      item.parent in index\r\n        ? R.assoc(item.id, [], R.assoc(item.parent, R.append(item.id, index[item.parent]), index))\r\n        : R.assoc(item.id, [], index),\r\n    {},\r\n    items,\r\n  ); //=> E.g. {\"1\":[2],\"2\":[3],\"3\":[],\"4\":[]}\r\n  const index = R.map(R.head, R.groupBy(R.prop('id'), items)); //=> E.g. {\"!\": <item1>, \"2\": <item2>, ...}\r\n  const assoc = id => {\r\n    const childNodes = id => R.map(makeNode, hierarchy[id]);\r\n    return R.isEmpty(childNodes(id)) ? index[id] : R.assoc('childNodes', childNodes(id), index[id]);\r\n  };\r\n  const makeNode = id => R.dissoc('parent', assoc(id));\r\n  return R.map(makeNode, R.pluck('id', R.filter(item => R.isNil(item.parent), items)));\r\n};\r\n\r\nexport const computeHasSpotlight = values => {\r\n  const LIMIT = 8;\r\n  if (R.gt(R.length(values), LIMIT)) return true;\r\n\r\n  const computeflatArray = (acc, item) => {\r\n    if (item.childNodes) return R.reduce(computeflatArray, acc, item.childNodes);\r\n    return [...acc, item.id];\r\n  };\r\n\r\n  return R.gt(R.length(R.reduce(computeflatArray, [], values)), LIMIT);\r\n};\r\n","import { createSelector } from 'reselect';\r\nimport * as R from 'ramda';\r\nimport { sdmxPeriod } from '../lib/settings';\r\nimport { dimensionFormats } from '../lib/utils';\r\n\r\n//------------------------------------------------------------------------------------------------#0\r\nconst getVis = R.prop('vis');\r\n\r\n//------------------------------------------------------------------------------------------------#1\r\nexport const getPeriod = createSelector(\r\n  getVis,\r\n  R.pipe(\r\n    R.prop('period'),\r\n    R.ifElse(R.pipe(R.length, R.equals(2)), R.identity, R.always(sdmxPeriod)),\r\n  ),\r\n);\r\n\r\nexport const getViewer = createSelector(getVis, R.prop('viewer'));\r\n\r\nexport const getAction = createSelector(getVis, R.prop('action'));\r\n\r\nexport const getDisplay = createSelector(getVis, R.prop('display'));\r\n\r\nexport const getFilter = createSelector(getVis, R.prop('filter'));\r\n\r\nexport const getDataflow = createSelector(getVis, R.prop('dataflow'));\r\n\r\nexport const getDataquery = createSelector(getVis, R.prop('dataquery'));\r\n\r\nexport const getIsFullscreen = createSelector(getVis, R.prop('isFullscreen'));\r\n\r\nexport const getTimeDimensionInverted = createSelector(getVis, R.prop('timeDimensionInverted'));\r\n\r\nexport const getLayout = createSelector(getVis, R.prop('layout'));\r\n\r\nexport const getDimensionGetter = createSelector(getVis, R.prop('dimensionGetter'));\r\n\r\nexport const getDimensionFormat = createSelector(\r\n  getDimensionGetter,\r\n  R.flip(R.prop)(dimensionFormats),\r\n);\r\n","import { createSelector } from 'reselect';\r\nimport * as R from 'ramda';\r\nimport Set from 'es6-set';\r\nimport { getDataquery as getVisDataquery, getDimensionFormat } from './vis';\r\nimport { getSdmxAttribute } from '../lib/settings';\r\n\r\n//------------------------------------------------------------------------------------------------#0\r\nconst getSdmx = R.prop('sdmx');\r\n\r\n//------------------------------------------------------------------------------------------------#1\r\nexport const getDimensions = createSelector(getSdmx, R.prop('dimensions'));\r\n\r\nexport const getData = createSelector(getSdmx, R.prop('data'));\r\n\r\nexport const getLayout = createSelector(getSdmx, R.prop('layout'));\r\n\r\n//------------------------------------------------------------------------------------------------#2\r\nexport const getDataquery = createSelector(\r\n  getVisDataquery,\r\n  getDimensions,\r\n  (dataquery, dimensions) => {\r\n    // dataquery in state is priority 1\r\n    if (R.not(R.anyPass([R.isEmpty, R.isNil])(dataquery))) return dataquery;\r\n\r\n    // dataquery extracted from dimensions default selection is priority 2\r\n    return R.pipe(\r\n      R.map(\r\n        R.pipe(\r\n          R.prop('values'),\r\n          R.filter(R.propEq('isDefaultSelected', true)),\r\n          R.pluck('id'),\r\n          R.join('+'),\r\n        ),\r\n      ),\r\n      R.join('.'),\r\n    )(dimensions);\r\n  },\r\n);\r\n\r\nexport const getCustomAttributes = createSelector(getData, getDimensionFormat, (data, format) => {\r\n  const flagsSet = new Set(getSdmxAttribute('flags'));\r\n  const attrs = R.pathOr([], ['structure', 'attributes', 'observation'])(data);\r\n  const isFootnote = true;\r\n\r\n  const customAttrs = R.addIndex(R.reduce)(\r\n    (memo, { id, name, values, ...rattr }, index) => {\r\n      const attr = { ...rattr, id, values, index, isFootnote, label: format({ id, name }) };\r\n\r\n      // flags defined in SETTINGS are *forced* footnotes\r\n      // footnote is annotation...\r\n      if (flagsSet.has(id)) return R.set(R.lensPath(['flags', index]), attr, memo);\r\n\r\n      // decimals is used to format the obs value\r\n      // should not be considered as a footnote\r\n      if (R.includes(id, getSdmxAttribute('decimals'))) return R.assoc('decimals', attr, memo);\r\n\r\n      // real footnotes handling: if single valued then footnote\r\n      if (R.pipe(R.length, R.equals(1))(values))\r\n        return R.over(R.lensProp('footnotes'), R.append(attr), memo);\r\n\r\n      // if multi valued then flag\r\n      if (R.pipe(R.isEmpty, R.not)(values)) return R.set(R.lensPath(['flags', index]), attr, memo);\r\n\r\n      return memo;\r\n    },\r\n    { flags: {} /* , decimals: undefined */, footnotes: [] },\r\n  )(attrs);\r\n\r\n  return customAttrs;\r\n});\r\n\r\n//------------------------------------------------------------------------------------------------#3\r\nexport const getFilters = createSelector(\r\n  getDimensions,\r\n  getDataquery,\r\n  R.pipe(\r\n    R.useWith(\r\n      (filters, dataquery) =>\r\n        R.addIndex(R.map)((filter, index) => {\r\n          if (R.pipe(R.nth(index), R.isEmpty)(dataquery)) return filter;\r\n          if (R.pipe(R.nth(index), R.isNil)(dataquery)) return filter;\r\n\r\n          const valueIdsSet = new Set(R.pipe(R.nth(index), R.split('+'))(dataquery));\r\n          return R.over(\r\n            R.lensProp('values'),\r\n            R.map(\r\n              R.ifElse(({ id }) => valueIdsSet.has(id), R.assoc('isSelected', true), R.identity),\r\n            ),\r\n            filter,\r\n          );\r\n        }, filters),\r\n      [R.identity, R.split('.')],\r\n    ),\r\n    R.filter(R.pipe(R.prop('values'), R.length, R.lt(1))),\r\n  ),\r\n);\r\n\r\n//------------------------------------------------------------------------------------------------#4\r\nexport const getSelection = createSelector(\r\n  getFilters,\r\n  R.pipe(\r\n    R.map(R.over(R.lensProp('values'), R.filter(R.propEq('isSelected', true)))),\r\n    R.filter(R.pipe(R.prop('values'), R.length, R.flip(R.gt)(0))),\r\n  ),\r\n);\r\n","import * as R from 'ramda';\r\nimport { updateDataquery } from '../lib/sdmx';\r\nimport { getDimensions } from '../selectors/sdmx';\r\n\r\n//-----------------------------------------------------------------------------------------constants\r\nexport const CHANGE_PERIOD = '@@vis/sdmx/CHANGE_PERIOD';\r\nexport const CHANGE_FILTER = '@@vis/CHANGE_FILTER';\r\nexport const CHANGE_VIEWER = '@@vis/CHANGE_VIEWER';\r\nexport const CHANGE_ACTION = '@@vis/CHANGE_ACTION';\r\nexport const CHANGE_DATAFLOW = '@@vis/sdmx/CHANGE_DATAFLOW';\r\nexport const CHANGE_DATAQUERY = '@@vis/sdmx/CHANGE_DATAQUERY';\r\nexport const OVERRIDE_DATAQUERY = '@@vis/sdmx/OVERRIDE_DATAQUERY';\r\nexport const CHANGE_LAYOUT = '@@vis/CHANGE_LAYOUT';\r\nexport const CHANGE_DIMENSION_GETTER = '@@vis/CHANGE_DIMENSION_GETTER';\r\nexport const CHANGE_IS_TIME_DIMENSION_INVERTED = '@@vis/CHANGE_IS_TIME_DIMENSION_INVERTED';\r\n\r\n//------------------------------------------------------------------------------------------creators\r\nexport const changePeriod = period => ({ type: CHANGE_PERIOD, payload: { period } });\r\nexport const changeFilter = filterId => ({ type: CHANGE_FILTER, payload: { filterId } });\r\nexport const changeViewer = viewerId => ({ type: CHANGE_VIEWER, payload: { viewerId } });\r\nexport const changeAction = actionId => ({ type: CHANGE_ACTION, payload: { actionId } });\r\nexport const changeDataflow = dataflow => ({ type: CHANGE_DATAFLOW, payload: { dataflow } });\r\nexport const changeLayout = layout => ({ type: CHANGE_LAYOUT, payload: { layout } });\r\nexport const changeDimensionGetter = dimensionGetter => ({\r\n  type: CHANGE_DIMENSION_GETTER,\r\n  payload: { dimensionGetter },\r\n});\r\nexport const changeIsTimeDimensionInverted = (id, isTimeDimensionInverted) => ({\r\n  type: CHANGE_IS_TIME_DIMENSION_INVERTED,\r\n  payload: { id, isTimeDimensionInverted },\r\n});\r\nexport const changeDataquery = (filterId, valueId) => (dispatch, getState) =>\r\n  dispatch({\r\n    type: CHANGE_DATAQUERY,\r\n    payload: { filterId, valueId, dimensions: getDimensions(getState()) },\r\n  });\r\n\r\n//-------------------------------------------------------------------------------------------reducer\r\nexport default (state = {}, action = {}) => {\r\n  switch (action.type) {\r\n    case CHANGE_ACTION:\r\n      var isFullscreen = R.always(R.equals(action.payload.actionId, 'fullscreen'));\r\n      return R.evolve({\r\n        isFullscreen: R.ifElse(isFullscreen, R.not, R.identity),\r\n        action: R.cond([\r\n          [isFullscreen, R.identity],\r\n          [R.equals(action.payload.actionId), R.always(undefined)],\r\n          [R.T, R.always(action.payload.actionId)],\r\n        ]),\r\n      })(state);\r\n    case CHANGE_FILTER:\r\n      return R.over(\r\n        R.lensProp('filter'),\r\n        filter =>\r\n          R.ifElse(R.equals(filter), R.always(undefined), R.identity)(\r\n            R.path(['payload', 'filterId'], action),\r\n          ),\r\n        state,\r\n      );\r\n    case CHANGE_PERIOD:\r\n      return R.set(R.lensProp('period'), R.path(['payload', 'period'], action), state);\r\n    case CHANGE_VIEWER:\r\n      return R.set(R.lensProp('viewer'), R.path(['payload', 'viewerId'], action), state);\r\n    case CHANGE_LAYOUT:\r\n      return R.set(R.lensProp('layout'), R.path(['payload', 'layout'], action), state);\r\n    case CHANGE_DIMENSION_GETTER:\r\n      return R.set(\r\n        R.lensProp('dimensionGetter'),\r\n        R.path(['payload', 'dimensionGetter'], action),\r\n        state,\r\n      );\r\n    case CHANGE_IS_TIME_DIMENSION_INVERTED:\r\n      return {\r\n        ...state,\r\n        timeDimensionInverted: R.set(\r\n          R.lensProp(action.payload.id),\r\n          !action.payload.isTimeDimensionInverted,\r\n          state.timeDimensionInverted,\r\n        ),\r\n      };\r\n    case CHANGE_DATAQUERY:\r\n      return R.over(\r\n        R.lensProp('dataquery'),\r\n        updateDataquery(R.path(['payload', 'dimensions'], action))(\r\n          R.path(['payload', 'filterId'], action),\r\n          R.path(['payload', 'valueId'], action),\r\n        ),\r\n        state,\r\n      );\r\n    case OVERRIDE_DATAQUERY:\r\n      return R.set(R.lensProp('dataquery'), R.prop('dataquery', action), state);\r\n    case CHANGE_DATAFLOW:\r\n      return R.pipe(\r\n        R.set(R.lensProp('viewer'), 'table'),\r\n        R.set(R.lensProp('dataquery'), R.path(['payload', 'dataflow', 'dataquery'], action)),\r\n        R.set(R.lensProp('period'), R.path(['payload', 'dataflow', 'period'], action)),\r\n        R.flip(R.merge)(R.prop('payload', action)),\r\n      )(state);\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { createSelector } from 'reselect';\r\nimport * as R from 'ramda';\r\n\r\n//------------------------------------------------------------------------------------------------#0\r\nconst getApp = R.prop('app');\r\n\r\n//------------------------------------------------------------------------------------------------#1\r\nexport const getLocale = createSelector(getApp, R.prop('locale'));\r\n\r\nexport const getPending = createSelector(getApp, R.prop('pending'));\r\n\r\n//------------------------------------------------------------------------------------------------#2\r\nexport const getIsPending = id => createSelector(getPending, R.pipe(R.prop(id), R.equals(true)));\r\n\r\nexport const getIsRtl = createSelector(getLocale, R.propEq('isRtl', true));\r\n","'use strict';\r\n\r\nexport const mapStructure = (s, lang) => {\r\n  const ret = {};\r\n  ret.meta = {\r\n    'content-languages': [lang],\r\n    schema:\r\n      'https://raw.githubusercontent.com/sdmx-twg/sdmx-json/develop/structure-message/tools/schemas/1.0/sdmx-json-structure-schema.json',\r\n  };\r\n\r\n  ret.data = {};\r\n\r\n  //Dataflow\r\n  ret.data.dataflows = s.Dataflow;\r\n  renameKey(ret.data.dataflows[0], 'agencyId', 'agencyID');\r\n  ret.data.dataflows[0].name = convertName(s.Dataflow[0].names);\r\n  delete s.Dataflow[0].names;\r\n  ret.data.dataflows[0].structure = s.Dataflow[0].dataStructureRef;\r\n  ret.data.dataflows[0].links = createLinkNode('self', s.Dataflow[0].urn, 'dataflow');\r\n  ret.data.dataflows[0].links = ret.data.dataflows[0].links.concat(\r\n    createLinkNode('structure', s.Dataflow[0].dataStructureRef, 'datastructure'),\r\n  );\r\n\r\n  //conceptscheme\r\n  ret.data.conceptSchemes = s.ConceptScheme;\r\n  ret.data.conceptSchemes[0].name = convertName(s.ConceptScheme[0].names);\r\n  delete ret.data.conceptSchemes[0].names;\r\n  renameKey(ret.data.conceptSchemes[0], 'agencyId', 'agencyID');\r\n  renameKey(ret.data.conceptSchemes[0], 'items', 'concepts');\r\n\r\n  ret.data.conceptSchemes[0].concepts.forEach(v => {\r\n    v.name = convertName(v.names);\r\n    delete v.names;\r\n  });\r\n  ret.data.conceptSchemes[0].links = createLinkNode(\r\n    'self',\r\n    s.ConceptScheme[0].urn,\r\n    'conceptscheme',\r\n  );\r\n\r\n  //codelists\r\n  ret.data.codelists = s.Codelist;\r\n\r\n  ret.data.codelists.forEach(cl => {\r\n    renameKey(cl, 'agencyId', 'agencyID');\r\n    cl.name = convertName(cl.names);\r\n    delete cl.names;\r\n    renameKey(cl, 'items', 'codes');\r\n    cl.links = createLinkNode('self', cl.urn, 'codelist');\r\n\r\n    if (cl.codes) {\r\n      let hasUniqueRoot = isUniqueRoot(cl.codes);\r\n      cl.codes.forEach(c => {\r\n        c.name = convertName(c.names);\r\n        delete c.names;\r\n        if (c.parentCode && !hasUniqueRoot) {\r\n          renameKey(c, 'parentCode', 'parent');\r\n        }\r\n        c.links = createLinkNode('self', c.urn, 'code');\r\n      });\r\n    }\r\n  });\r\n\r\n  /*\r\n      ret.data.dataStructures = s.DataStructure;\r\n      ret.data.dataStructures[0].dataStructureComponents = {};\r\n      ret.data.dataStructures[0].dataStructureComponents.dimensionList = s.DataStructure[0].dimensionList;\r\n  \r\n      */\r\n  //dataStructures\r\n  ret.data.dataStructures = s.DataStructure;\r\n  renameKey(ret.data.dataStructures[0], 'agencyId', 'agencyID');\r\n  ret.data.dataStructures[0].dataStructureComponents = {};\r\n  ret.data.dataStructures[0].name = convertName(ret.data.dataStructures[0].names);\r\n  delete ret.data.dataStructures[0].names;\r\n  ret.data.dataStructures[0].links = createLinkNode(\r\n    'self',\r\n    ret.data.dataStructures[0].urn,\r\n    'datastructure',\r\n  );\r\n  //dataStructures - DimensionsList\r\n  ret.data.dataStructures[0].dataStructureComponents.dimensionList =\r\n    s.DataStructure[0].dimensionList;\r\n  var pos = 0;\r\n  var timePos = -1;\r\n  ret.data.dataStructures[0].dimensionList.dimensions.forEach(d => {\r\n    d.links = createLinkNode('self', d.urn, 'dimension');\r\n    d.type = 'Dimension';\r\n    renameKey(d, 'concept', 'conceptIdentity');\r\n    d.position = pos++;\r\n    if (d.representation && d.representation.representation) {\r\n      d.localRepresentation = { enumeration: d.representation.representation };\r\n    }\r\n    if (d.isTimeDimension) {\r\n      timePos = pos - 1;\r\n      ret.data.dataStructures[0].dimensionList.timeDimensions = [\r\n        {\r\n          id: d.id,\r\n          urn: d.urn,\r\n          links: createLinkNode(d.links[0].rel, d.links[0].urn, d.links[0].type),\r\n          position: d.position,\r\n          type: d.type,\r\n          conceptIdentity: d.conceptIdentity,\r\n          localRepresentation: {\r\n            textFormat: {\r\n              textType: 'ObservationalTimePeriod',\r\n              isSequence: false,\r\n              isMultiLingual: false,\r\n            },\r\n          },\r\n        },\r\n      ];\r\n    }\r\n  });\r\n\r\n  if (timePos != -1) ret.data.dataStructures[0].dimensionList.dimensions.splice(timePos, timePos);\r\n  delete ret.data.dataStructures[0].dimensionList;\r\n\r\n  //dataStructures - measureList\r\n  ret.data.dataStructures[0].dataStructureComponents.measureList = {};\r\n  ret.data.dataStructures[0].dataStructureComponents.measureList.primaryMeasure =\r\n    s.DataStructure[0].primaryMeasure;\r\n  ret.data.dataStructures[0].dataStructureComponents.measureList.primaryMeasure.links = createLinkNode(\r\n    'self',\r\n    ret.data.dataStructures[0].dataStructureComponents.measureList.primaryMeasure.urn,\r\n    'primarymeasure',\r\n  );\r\n  renameKey(\r\n    ret.data.dataStructures[0].dataStructureComponents.measureList.primaryMeasure,\r\n    'concept',\r\n    'conceptIdentity',\r\n  );\r\n  renameKey(\r\n    ret.data.dataStructures[0].dataStructureComponents.measureList.primaryMeasure,\r\n    'representation',\r\n    'localRepresentation',\r\n  );\r\n\r\n  /* ret.data.dataStructures[0].dataStructureComponents.measureList.primaryMeasure.localRepresentation={\r\n           \"textFormat\": {\r\n               \"textType\": \"Double\",\r\n               \"sequence\": false\r\n           }\r\n       };*/\r\n  delete ret.data.dataStructures[0].primaryMeasure;\r\n\r\n  //dataStructures - attributeList\r\n  ret.data.dataStructures[0].dataStructureComponents.attributeList =\r\n    s.DataStructure[0].attributeList;\r\n\r\n  if (ret.data.dataStructures[0].dataStructureComponents.attributeList) {\r\n    ret.data.dataStructures[0].dataStructureComponents.attributeList.attributes.forEach(a => {\r\n      if (a.mandatory) {\r\n        a.assignmentStatus = 'Mandatory';\r\n      } else {\r\n        a.assignmentStatus = 'Conditional';\r\n      }\r\n      a.attributeRelationship = {\r\n        dimensions: a.dimensionReferences,\r\n      };\r\n      renameKey(a, 'concept', 'conceptIdentity');\r\n      a.links = createLinkNode('self', a.urn, 'dataattribute');\r\n      if (a.representation && a.representation.representation)\r\n        a.localRepresentation = { enumeration: a.representation.representation };\r\n    });\r\n  }\r\n\r\n  delete ret.data.dataStructures[0].attributeList;\r\n\r\n  /*console.log('RETURNING STRUCTURE');\r\n  console.log(JSON.stringify(ret));\r\n  console.log(ret);*/\r\n\r\n  return ret;\r\n};\r\n\r\nfunction isUniqueRoot(codes) {\r\n  if (!codes) {\r\n    return false;\r\n  }\r\n  let noParentCount = 0;\r\n  //two roots\r\n  for (let i = 0; i < codes.length; i++) {\r\n    if (!codes[i].parentCode) {\r\n      noParentCount++;\r\n    }\r\n    if (noParentCount > 1) return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nconst convertName = names => {\r\n  const ret = {};\r\n  names.forEach(v => {\r\n    ret[v.locale] = v.value;\r\n  });\r\n  return ret;\r\n};\r\n\r\nconst renameKey = (object, oldKey, newKey) => {\r\n  if (!object[oldKey]) return;\r\n  object[newKey] = object[oldKey];\r\n  delete object[oldKey];\r\n};\r\n\r\nconst createLinkNode = (rel, urn, type) => {\r\n  return [{ rel: rel, urn: urn, type: type }];\r\n};\r\n\r\n//DATA\r\n\r\nconst convertLanguageNode = (text, lang) => {\r\n  if (text == null) return null;\r\n  var ret = {};\r\n  ret[lang] = text;\r\n  return ret;\r\n};\r\n\r\nconst convertCodelist = (cl, lang) => {\r\n  cl.name = convertLanguageNode(cl.name, lang);\r\n  cl.roles = [cl.id];\r\n  if (cl.values) {\r\n    cl.values.forEach(v => {\r\n      v.name = convertLanguageNode(v.name, lang);\r\n    });\r\n  }\r\n};\r\n\r\nconst convert_struct_component = (comp, lang) => {\r\n  if (comp) {\r\n    comp.forEach(v => {\r\n      convertCodelist(v, lang);\r\n      /*v.relationship= {\r\n                    \"primaryMeasure\": \"OBS_VALUE\"\r\n                  };*/\r\n    });\r\n  }\r\n};\r\n\r\nexport const mapData = (d, lang) => {\r\n  const ret = {};\r\n  //meta\r\n  ret.meta = d.header;\r\n  ret.meta['content-languages'] = [lang];\r\n\r\n  if (!d.dataSets[0].observations){return null;}\r\n\r\n  //data\r\n  ret.data = {};\r\n  ret.data.dataSets = d.dataSets;\r\n  ret.data.structure = {};\r\n\r\n  \r\n\r\n  ret.data.structure.name = {};\r\n  ret.data.structure.name[lang] = d.structure.name;\r\n  ret.data.structure.description = convertLanguageNode(d.structure.description);\r\n  ret.data.structure.dimensions = d.structure.dimensions;\r\n  ret.data.structure.attributes = d.structure.attributes;\r\n  ret.data.structure.attributes.dataSet = d.structure.attributes.dataset;\r\n\r\n  convert_struct_component(ret.data.structure.dimensions.dataset, lang);\r\n  convert_struct_component(ret.data.structure.dimensions.series, lang);\r\n  convert_struct_component(ret.data.structure.dimensions.observation, lang);\r\n  convert_struct_component(ret.data.structure.attributes.dataset, lang);\r\n  convert_struct_component(ret.data.structure.attributes.series, lang);\r\n  convert_struct_component(ret.data.structure.attributes.observation, lang);\r\n\r\n  //let toParse = true;\r\n  for (let k in ret.data.dataSets[0].observations) {\r\n    if (ret.data.dataSets[0].observations.hasOwnProperty(k)) {\r\n      if (\r\n        ret.data.dataSets[0].observations[k][0] &&\r\n        !isNaN(ret.data.dataSets[0].observations[k][0])\r\n      ) {\r\n        ret.data.dataSets[0].observations[k][0] = parseFloat(\r\n          ret.data.dataSets[0].observations[k][0],\r\n        );\r\n      }\r\n    }\r\n  }\r\n  /*\r\n  for (let k in ret.data.dataSets[0].observations) {\r\n    if (ret.data.dataSets[0].observations.hasOwnProperty(k)) {\r\n      console.log(ret.data.dataSets[0].observations[k][0]);\r\n    }}*/\r\n\r\n  /*if (toParse) {\r\n    for (let k in ret.data.dataSets[0].observations) {\r\n      if (ret.data.dataSets[0].observations.hasOwnProperty(k)) {\r\n        ret.data.dataSets[0].observations[k][0] = parseFloat(\r\n          ret.data.dataSets[0].observations[k][0],\r\n        );\r\n      }\r\n    }\r\n  }*/\r\n\r\n  /*ret.data.dataSets[0].footnotes = { sourceLabel: 'sdlkjhlzskh', source: 'sdfgsd' };\r\n  ret.data.structure.footnotes = { sourceLabel: 'sdlkjhlzskh', source: 'sdfgsd' };\r\n  ret.data.footnotes = { sourceLabel: 'sdlkjhlzskh', source: 'sdfgsd' };\r\n  ret.meta.footnotes = { sourceLabel: 'sdlkjhlzskh', source: 'sdfgsd' };\r\n  ret.meta.footnotes = { sourceLabel: 'sdlkjhlzskh', source: 'sdfgsd' };*/\r\n\r\n  //console.log(\"RETURNING DATA\");\r\n  //console.log(JSON.stringify(ret));\r\n  //console.log(ret);\r\n\r\n  return ret;\r\n};\r\n","import * as R from 'ramda';\r\nimport axios from 'axios';\r\nimport FileSaver from 'file-saver';\r\nimport { rules } from '@sis-cc/dotstatsuite-components';\r\nimport { structureParser, getConfig, getFilename, getFusionConfig } from '../lib/sdmx';\r\nimport { sdmxRange } from '../lib/settings';\r\nimport * as fm from './formatMapper';\r\n\r\nconst getLocale = R.pathOr('en', ['locale', 'id']);\r\n\r\nconst getStructure = ({ configArgs }) => {\r\n  const { url, datasource } =\r\n    R.prop('backendId', configArgs.dataflow) == 'FUSION'\r\n      ? getFusionConfig({ configArgs })\r\n      : getConfig({ type: 'structure' })({ configArgs });\r\n\r\n  const qStringParams =\r\n    R.prop('backendId', configArgs.dataflow) == 'FUSION'\r\n      ? { references: 'all', format: 'sdmx-json', detail: 'structureOnly', includeMetrics: true }\r\n      : { references: 'all' };\r\n\r\n  const acceptParam =\r\n    R.prop('backendId', configArgs.dataflow) == 'FUSION'\r\n      ? {\r\n          'Accept-Language': getLocale(configArgs),\r\n        }\r\n      : {\r\n          Accept: 'application/vnd.sdmx.structure+json;version=1.0',\r\n          'Accept-Language': getLocale(configArgs),\r\n        };\r\n\r\n  const mapSDMX_structure = data => {\r\n    return data.data;\r\n  };\r\n  const mapSDMX_structureFusion = data => {\r\n    return fm.mapStructure(data.data, configArgs.locale.id);\r\n  };\r\n\r\n  const sdmxMapperStruct =\r\n    R.prop('backendId', configArgs.dataflow) == 'FUSION'\r\n      ? mapSDMX_structureFusion\r\n      : mapSDMX_structure;\r\n\r\n  return (\r\n    axios\r\n      .get(url, {\r\n        params: R.cond([\r\n          [\r\n            R.always(R.prop('supportsReferencePartial', datasource)),\r\n            R.assoc('detail', 'referencepartial'),\r\n          ],\r\n          [R.T, R.identity],\r\n        ])(qStringParams),\r\n        headers: acceptParam,\r\n      })\r\n      //.then(R.pipe(R.prop('data'), structureParser));\r\n      .then(R.pipe(sdmxMapperStruct, structureParser))\r\n  );\r\n};\r\n\r\nconst getData = ({ configArgs, requestArgs }) => {\r\n  const { url, datasource } = getConfig({ type: 'data' })({ configArgs });\r\n\r\n  const mapSDMX_data = data => {\r\n    return data.data;\r\n  };\r\n  const mapSDMX_dataFusion = data => {\r\n    // let d=fm.mapData(data.data, configArgs.locale.id);\r\n\r\n    // const keys = Object.keys(d.data.dataSets[0].observations);\r\n    // console.log(\"Keys: \"+ keys.length);\r\n    // if (keys.length>1000){\r\n    //   console.log(\"deleting keys\");\r\n    // for( let i=1000;i<keys.length;i++){\r\n    //   delete d.data.dataSets[0].observations[keys[i]];\r\n    // }}\r\n\r\n    // return d;\r\n    return fm.mapData(data.data, configArgs.locale.id);\r\n  };\r\n\r\n  const sdmxMapperData =\r\n    R.prop('backendId', configArgs.dataflow) == 'FUSION' ? mapSDMX_dataFusion : mapSDMX_data;\r\n\r\n  return (\r\n    axios\r\n      .get(url, {\r\n        params: R.mergeRight({ dimensionAtObservation: 'AllDimensions' }, requestArgs),\r\n        headers: R.cond([\r\n          [\r\n            R.always(R.prop('hasRangeHeader', datasource)),\r\n            R.assoc('Range', `values=${R.head(sdmxRange)}-${R.last(sdmxRange)}`),\r\n          ],\r\n          [R.T, R.identity],\r\n        ])({\r\n          Accept: 'application/vnd.sdmx.data+json;version=1.0.0-wd',\r\n          'Accept-Language': getLocale(configArgs),\r\n        }),\r\n      })\r\n      //.then(R.pipe(R.prop('data'), rules.v8Transformer));\r\n      .then(R.pipe(sdmxMapperData, rules.v8Transformer))\r\n  );\r\n};\r\n\r\nconst getDataFile = ({ configArgs, requestArgs }) => {\r\n  const { url } = getConfig({ type: 'data' })({ configArgs });\r\n\r\n  return axios\r\n    .get(url, {\r\n      params: requestArgs,\r\n      headers: {\r\n        Accept: 'application/vnd.sdmx.data+csv;file=true',\r\n        'Accept-Language': getLocale(configArgs),\r\n      },\r\n      responseType: 'blob',\r\n    })\r\n    .then(response => {\r\n      const blob = new Blob([R.prop('data')(response)], {\r\n        type: R.pathOr('text/csv', ['headers', 'content-type'])(response),\r\n      });\r\n      FileSaver.saveAs(blob, `${getFilename(configArgs)}.csv`);\r\n    });\r\n};\r\n\r\nconst methods = { getStructure, getData, getDataFile };\r\n\r\nconst error = method => () => {\r\n  throw new Error(`Unkown method: ${method}`);\r\n};\r\nconst main = ({ method, ...rest }) => (methods[method] || error(method))(rest);\r\nR.compose(R.forEach(([name, fn]) => (main[name] = fn)), R.toPairs)(methods);\r\n\r\nexport default main;\r\n","import * as R from 'ramda';\r\nimport { getDataflow, getPeriod } from '../selectors/vis';\r\nimport { getLocale } from '../selectors/app';\r\nimport { getDataquery } from '../selectors/sdmx';\r\nimport sdmxApi from '../api/sdmx';\r\nimport { OVERRIDE_DATAQUERY } from './vis';\r\nimport { setPending, pushLog, LOG_ERROR } from './app';\r\n\r\nconst isDev = process.env.NODE_ENV === 'development';\r\n\r\n//-----------------------------------------------------------------------------------------constants\r\nexport const HANDLE_STRUCTURE = '@@sdmx/HANDLE_STRUCTURE';\r\nexport const HANDLE_DATA = '@@sdmx/HANDLE_DATA';\r\n\r\n//--------------------------------------------------------------------------------------thunks (api)\r\nconst request = (dispatch, ctx) => {\r\n  const { method } = ctx;\r\n  const pendingId = ctx.pendingId || method;\r\n\r\n  // eslint-disable-next-line no-console\r\n  if (isDev) console.info(`request: ${pendingId}`);\r\n\r\n  dispatch(setPending(pendingId, true));\r\n  return sdmxApi(ctx)\r\n    .then(res => {\r\n      dispatch(setPending(pendingId));\r\n      return res;\r\n    })\r\n    .catch(error => {\r\n      const log = error.response\r\n        ? { method, errorCode: error.response.data.errorCode, statusCode: error.response.status }\r\n        : { method, error };\r\n\r\n      dispatch(setPending(pendingId));\r\n      dispatch(pushLog({ type: LOG_ERROR, payload: { log } }));\r\n\r\n      // required to break the promised chain\r\n      throw error;\r\n    });\r\n};\r\n\r\nexport const requestStructure = ({ shouldRequestStructure }) => (dispatch, getState) => {\r\n  if (R.not(shouldRequestStructure)) return Promise.resolve();\r\n\r\n  const configArgs = {\r\n    locale: getLocale(getState()),\r\n    dataflow: getDataflow(getState()),\r\n  };\r\n  return request(dispatch, { method: 'getStructure', configArgs }).then(structure => {\r\n    dispatch({ type: HANDLE_STRUCTURE, structure });\r\n  });\r\n};\r\n\r\nexport const requestData = ({ shouldRequestStructure } = {}) => (dispatch, getState) => {\r\n  requestStructure({ shouldRequestStructure })(dispatch, getState).then(() => {\r\n    const requestArgs = {\r\n      startPeriod: R.head(getPeriod(getState())),\r\n      endPeriod: R.last(getPeriod(getState())),\r\n    };\r\n    const dataquery = getDataquery(getState());\r\n    const dataflow = getDataflow(getState());\r\n    const configArgs = {\r\n      locale: getLocale(getState()),\r\n      dataflow,\r\n      dataquery,\r\n    };\r\n    dispatch({ type: OVERRIDE_DATAQUERY, dataquery });\r\n    return request(dispatch, { method: 'getData', configArgs, requestArgs }).then(\r\n      ({ data, layout }) => {\r\n        // UNICEF specific\r\n        document.getElementById('root').dispatchEvent(\r\n          new CustomEvent('unicef_dataflowLoaded', {\r\n            detail: {\r\n              dataflow,\r\n              data,\r\n            },\r\n          }),\r\n        );\r\n\r\n        dispatch({ type: HANDLE_DATA, data, layout });\r\n      },\r\n    );\r\n  });\r\n};\r\n\r\nexport const requestDataFile = ({ isDownloadAllData, dataflow } = {}) => (dispatch, getState) => {\r\n  const requestArgs = isDownloadAllData\r\n    ? {}\r\n    : { startPeriod: R.head(getPeriod(getState())), endPeriod: R.last(getPeriod(getState())) };\r\n  const configArgs = R.cond([\r\n    [R.always(R.not(isDownloadAllData)), R.assoc('dataquery', getDataquery(getState()))],\r\n    [R.T, R.identity],\r\n  ])({\r\n    locale: getLocale(getState()),\r\n    dataflow,\r\n  });\r\n  const pendingId = R.ifElse(\r\n    R.has('id'),\r\n    R.pipe(R.prop('id'), id => `getDataFile/${id}`),\r\n    R.always('requestingDataFile'),\r\n  )(dataflow);\r\n  return request(dispatch, { method: 'getDataFile', configArgs, requestArgs, pendingId });\r\n};\r\n\r\n//-------------------------------------------------------------------------------------------reducer\r\nexport default (state = {}, action = {}) => {\r\n  switch (action.type) {\r\n    case HANDLE_STRUCTURE:\r\n      return R.set(R.lensProp('dimensions'), R.path(['structure', 'dimensions'], action), state);\r\n    case HANDLE_DATA:\r\n      return R.pipe(\r\n        R.set(R.lensProp('data'), R.prop('data', action)),\r\n        R.set(R.lensProp('layout'), R.prop('layout', action)),\r\n      )(state);\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { combineReducers } from 'redux';\r\nimport app from '../ducks/app';\r\nimport vis from '../ducks/vis';\r\nimport sdmx from '../ducks/sdmx';\r\n\r\nexport default combineReducers({ app, sdmx, vis });\r\n","import * as R from 'ramda';\r\nimport { CHANGE_DATAQUERY, CHANGE_PERIOD, CHANGE_DATAFLOW } from '../ducks/vis';\r\nimport { requestData } from '../ducks/sdmx';\r\n\r\nconst isDev = process.env.NODE_ENV === 'development';\r\n\r\nexport const requestDataMiddleware = ({ dispatch }) => next => action => {\r\n  const future = next(action);\r\n\r\n  if (R.pipe(R.prop('type'), R.flip(R.includes)([CHANGE_DATAQUERY, CHANGE_PERIOD]))(action)) {\r\n    // eslint-disable-next-line no-console\r\n    if (isDev) console.info(`requestDataMiddleware: ${action.type}`);\r\n\r\n    dispatch(requestData());\r\n  }\r\n\r\n  if (R.pipe(R.prop('type'), R.flip(R.includes)([CHANGE_DATAFLOW]))(action)) {\r\n    // eslint-disable-next-line no-console\r\n    if (isDev) console.info(`requestStructureMiddleware: ${action.type}`);\r\n\r\n    dispatch(requestData({ shouldRequestStructure: true }));\r\n  }\r\n\r\n  return future;\r\n};\r\n","import { createStore, applyMiddleware, compose } from 'redux';\r\nimport thunk from 'redux-thunk';\r\nimport { createLogger } from 'redux-logger';\r\nimport { requestDataMiddleware } from './middlewares';\r\n\r\nexport const withLogger = middlewares => {\r\n  if (process.env.NODE_ENV === 'production') return middlewares;\r\n\r\n  const logger = createLogger({\r\n    duration: true,\r\n    timestamp: false,\r\n    collapsed: true,\r\n    diff: true,\r\n  });\r\n\r\n  return [...middlewares, logger];\r\n};\r\n\r\nexport default (initialState = {}, rootReducer) => {\r\n  const middlewares = [thunk, requestDataMiddleware];\r\n\r\n  const enhancers = [applyMiddleware(...withLogger(middlewares))];\r\n\r\n  const store = createStore(rootReducer, initialState, compose(...enhancers));\r\n\r\n  return store;\r\n};\r\n","import { createMuiTheme } from '@material-ui/core/styles';\r\n\r\nexport const Colors = {\r\n  GREY1: '#F0F0F0',\r\n  GREY2: '#CCCCCC',\r\n  GREY3: '#494444',\r\n  GREY4: '#A4A1A1',\r\n  GREY5: '#666666',\r\n  BLUE1: '#2973BD',\r\n  BLUE2: '#0965C1',\r\n  BLUE3: '#2F75B5',\r\n  BLUE4: '#BDD7EE',\r\n  BLUE5: '#DDEBF7',\r\n  BLUE6: '#1E226A',\r\n  WHITE1: '#FFFFFF',\r\n  BLACK1: '#000000',\r\n  GREEN1: '#8CC841',\r\n  ORANGE: '#f7a32c',\r\n};\r\n\r\nexport const FontSizes = {\r\n  SIZE1: 18,\r\n  SIZE2: 14,\r\n  SIZE3: 12,\r\n};\r\n\r\nexport const Formats = {\r\n  WIDE: 'initial',\r\n  NARROW: 400,\r\n  APP: 1000,\r\n  APP_MIN_SIZE: 360,\r\n  ITEM_MIN_SIZE: 350,\r\n};\r\n\r\nexport const Layout = {\r\n  PADDING: '5%',\r\n  SIDE_WIDTH: 300,\r\n  FILTER_MAX_HEIGHT: 250,\r\n};\r\n\r\nexport const theme = (rtl = 'ltr') =>\r\n  createMuiTheme({\r\n    overrides: {\r\n      MuiButton: {\r\n        text: {\r\n          textTransform: 'none',\r\n        },\r\n      },\r\n    },\r\n    palette: {\r\n      primary: {\r\n        main: '#137cbd',\r\n        mainAlpha: '#137cbd26',\r\n        light: '#5dabf0',\r\n        dark: '#00508c',\r\n        contrastText: '#ffffff',\r\n      },\r\n      secondary: {\r\n        main: '#bdd7ee',\r\n        light: '#f0ffff',\r\n        dark: '#8ca6bc',\r\n        contrastText: '#ff0000',\r\n      },\r\n      action: {\r\n        hover: '#bdd7ee',\r\n        selected: '#137cbd',\r\n        active: 'rgba(19,124,189,.3)',\r\n      },\r\n      typography: {\r\n        fontFamily: ['Segoe UI'],\r\n      },\r\n      raisedButton: {\r\n        textColor: '#ffffff',\r\n        primaryTextColor: '#ffffff',\r\n      },\r\n      default: {\r\n        backgroundColor: '#00000026', // grey with alpha\r\n      },\r\n      configLabelBG: '#B5CEEB',\r\n      configLabelCol: '#1C2768',\r\n    },\r\n    app: {\r\n      appSize: Formats.APP,\r\n      appMinSize: Formats.APP_MIN_SIZE,\r\n      itemMinSize: Formats.ITEM_MIN_SIZE,\r\n    },\r\n    scopeListContainer: {\r\n      maxHeight: 250,\r\n    },\r\n    scopeList: {\r\n      divider: '#000000',\r\n    },\r\n    direction: rtl,\r\n    typography: {\r\n      // until v4 https://material-ui.com/style/typography/#migration-to-typography-v2\r\n      useNextVariants: true,\r\n    },\r\n    configLabel: {\r\n      backgroundColor: '#B5CEEB',\r\n      color: '#43679F',\r\n      fontFamily: 'Segoe UI',\r\n      fontSize: 16,\r\n    },\r\n    configButtonRegular: {\r\n      backgroundColor: '#B5CEEB',\r\n      color: '#43679F',\r\n      fontFamily: 'Segoe UI',\r\n      fontSize: 16,\r\n      fontWeight: 'inherit',\r\n      textTransform: 'none',\r\n    },\r\n    configButtonSelected: {\r\n      backgroundColor: '#778899',\r\n      color: '#B5CEEB',\r\n      fontFamily: 'Segoe UI',\r\n      fontSize: 16,\r\n      fontWeight: 'inherit',\r\n      textTransform: 'none',\r\n    },\r\n    panelSummary: {\r\n      backgroundColor: '#137cbd',\r\n      color: 'white',\r\n      fontFamily: 'Segoe UI',\r\n      fontSize: 16,\r\n    },\r\n    panelIcon: {\r\n      color: 'white',\r\n    },\r\n    configInputs: {\r\n      backgroundColor: 'white',\r\n    },\r\n    alert: {\r\n      color: '#c23030',\r\n      hover: {\r\n        backgroundColor: 'rgba(219,55,55,.15)',\r\n      },\r\n      active: {\r\n        backgroundColor: 'rgba(219,55,55,.3)',\r\n      },\r\n    },\r\n    table: {\r\n      yBg: '#B5CEEB',\r\n      yBgHover: '#c3d7ef',\r\n      yBgActive: '#7e90a4',\r\n      yFontHeader: '#1C2768',\r\n      yFont: '#43679F',\r\n      zBg: '#386CAA',\r\n      zBgHover: '#5f89bb',\r\n      zBgActive: '#274b76',\r\n      zFontHeader: '#A2C2E4',\r\n      zFont: Colors.WHITE1,\r\n      xBg: Colors.WHITE1,\r\n      xBgHeader: '#D7E6F4',\r\n      xBgHover: '#dfebf6',\r\n      xBgActive: '#96a1aa',\r\n      xFontHeader: '#1C2768',\r\n      xFont: '#43679F',\r\n      oFont: Colors.GREY3,\r\n      sBg: Colors.GREY1,\r\n    },\r\n  });\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { mergeDeepRight } from 'ramda';\r\nimport { ThemeProvider } from 'glamorous';\r\nimport { mainTheme } from '@sis-cc/dotstatsuite-ui-components';\r\nimport rtl from 'jss-rtl';\r\nimport { create } from 'jss';\r\nimport { MuiThemeProvider } from '@material-ui/core/styles';\r\nimport { theme as muiTheme } from './theme';\r\nimport JssProvider from 'react-jss/lib/JssProvider';\r\nimport { createGenerateClassName, jssPreset } from '@material-ui/core/styles';\r\n\r\n// Configure JSS\r\nconst jss = create({ plugins: [...jssPreset().plugins, rtl()] });\r\n// Custom Material-UI class name generator.\r\nconst generateClassName = createGenerateClassName();\r\n\r\nconst Provider = ({ theme, children, isRtl }) => (\r\n  <JssProvider jss={jss} generateClassName={generateClassName}>\r\n    <MuiThemeProvider theme={muiTheme(isRtl ? 'rtl' : 'ltr')}>\r\n      <ThemeProvider theme={mergeDeepRight(mainTheme, theme)}>\r\n        {React.Children.only(children)}\r\n      </ThemeProvider>\r\n    </MuiThemeProvider>\r\n  </JssProvider>\r\n);\r\n\r\nProvider.propTypes = {\r\n  theme: PropTypes.object,\r\n  children: PropTypes.element.isRequired,\r\n  isRtl: PropTypes.bool,\r\n};\r\n\r\nexport default Provider;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport { DELayout, DELayoutContent, DESplash } from '@sis-cc/dotstatsuite-ui-components';\r\nimport logo from '../assets/data-explorer-logo.png';\r\n\r\nclass ErrorBoundary extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { hasError: false };\r\n  }\r\n\r\n  componentDidCatch() {\r\n    this.setState({ hasError: true });\r\n  }\r\n\r\n  render() {\r\n    if (!this.state.hasError) return this.props.children;\r\n\r\n    if (this.props.isFinal) return <h1>Whoops, something went wrong on our end.</h1>;\r\n\r\n    return (\r\n      <DELayout isHome>\r\n        <DELayoutContent>\r\n          <DESplash title={<FormattedMessage id=\"de.error.title\" />} logo={logo} />\r\n        </DELayoutContent>\r\n      </DELayout>\r\n    );\r\n  }\r\n}\r\n\r\nErrorBoundary.propTypes = {\r\n  children: PropTypes.node,\r\n  isFinal: PropTypes.bool,\r\n};\r\n\r\nexport default ErrorBoundary;\r\n","import React, { Fragment } from 'react';\r\nimport Responsive from 'react-responsive';\r\n\r\nconst Narrow = props => <Responsive {...props} query={`(max-width: ${700}px)`} />;\r\nconst Default = props => <Responsive {...props} query={`(min-width: ${700 + 1}px)`} />;\r\n\r\nexport default Component =>\r\n  class extends React.Component {\r\n    render = () => (\r\n      <Fragment>\r\n        <Narrow>\r\n          <Component {...this.props} isNarrow />\r\n        </Narrow>\r\n        <Default>\r\n          <Component {...this.props} />\r\n        </Default>\r\n      </Fragment>\r\n    );\r\n  };\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { createStructuredSelector } from 'reselect';\r\nimport { compose, withProps, pure } from 'recompose';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport { DEFilterPeriod } from '@sis-cc/dotstatsuite-ui-components';\r\nimport { changePeriod } from '../../ducks/vis';\r\nimport { getPeriod } from '../../selectors/vis';\r\nimport { sdmxPeriodBoundariesMinMax, sdmxPeriodBoundaries } from '../../lib/settings';\r\n\r\nexport default compose(\r\n  connect(createStructuredSelector({ period: getPeriod }), { changePeriod }),\r\n  withProps({\r\n    titleLabel: <FormattedMessage id=\"de.filter.period.title\" />,\r\n    //tagLabel: <FormattedMessage id=\"de.filter.period.tag\" values={sdmxPeriodBoundariesMinMax} />,\r\n    tagLabel: '',\r\n    periodBoundaries: sdmxPeriodBoundaries,\r\n    options: { ...sdmxPeriodBoundariesMinMax, labelStepSize: 10 },\r\n  }),\r\n  pure,\r\n)(DEFilterPeriod);\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { createStructuredSelector } from 'reselect';\r\nimport { compose, withProps, pure } from 'recompose';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport { VXFiltersCurrent } from '@sis-cc/dotstatsuite-ui-components';\r\nimport { changeDataquery } from '../../ducks/vis';\r\nimport { getSelection } from '../../selectors/sdmx';\r\n\r\nexport default compose(\r\n  connect(createStructuredSelector({ items: getSelection }), { changeFilters: changeDataquery }),\r\n  withProps({\r\n    titleLabel: <FormattedMessage id=\"vx.filters.current.title\" />,\r\n    clearAllLabel: <FormattedMessage id=\"vx.filters.current.clear\" />,\r\n    blankLabel: <FormattedMessage id=\"vx.filters.current.blank\" />,\r\n    noScroll: true,\r\n  }),\r\n  pure,\r\n)(VXFiltersCurrent);\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { createStructuredSelector } from 'reselect';\r\nimport { compose, withProps, pure } from 'recompose';\r\nimport * as R from 'ramda';\r\nimport { injectIntl } from 'react-intl';\r\nimport {\r\n  spotlightScopeListEngine,\r\n  VXScopeList,\r\n  VXSpotlight,\r\n} from '@sis-cc/dotstatsuite-ui-components';\r\nimport { changeFilter, changeDataquery } from '../../ducks/vis';\r\nimport { getFilter } from '../../selectors/vis';\r\nimport { getFilters } from '../../selectors/sdmx';\r\n\r\nconst Filter = pure(VXScopeList);\r\n\r\nexport default compose(\r\n  injectIntl,\r\n  connect(createStructuredSelector({ filters: getFilters, activePanelId: getFilter }), {\r\n    changeSelection: changeDataquery,\r\n    onChangeActivePanel: changeFilter,\r\n  }),\r\n  withProps(({ intl }) => ({\r\n    optionsSpotlight: {\r\n      hasClearAll: true,\r\n      mainPlaceholder: intl.formatMessage({ id: 'vx.spotlight.placeholder.primary' }),\r\n      secondaryPlaceholder: intl.formatMessage({ id: 'vx.spotlight.placeholder.secondary' }),\r\n    },\r\n    spotlight: {\r\n      engine: spotlightScopeListEngine,\r\n      placeholder: intl.formatMessage({ id: 'vx.spotlight.placeholder' }),\r\n      fields: {\r\n        'vx.spotlight.field.label': {\r\n          id: 'vx.spotlight.field.label',\r\n          accessor: R.pipe(R.propOr(null, 'label'), R.ifElse(R.isNil, R.always(''), R.identity)),\r\n          isSelected: true,\r\n        },\r\n      },\r\n    },\r\n    topElementComponent: values => (R.gte(R.length(values), 8) ? VXSpotlight : null),\r\n  })),\r\n  pure,\r\n)(({ topElementComponent, filters, ...parentProps }) =>\r\n  R.map(\r\n    ({ id, label, values }) => (\r\n      <Filter\r\n        {...parentProps}\r\n        id={id}\r\n        key={id}\r\n        label={label}\r\n        items={values}\r\n        TopElementComponent={topElementComponent(values)}\r\n      />\r\n    ),\r\n    filters,\r\n  ),\r\n);\r\n","import * as R from 'ramda';\r\nimport { rules } from '@sis-cc/dotstatsuite-components';\r\n\r\nexport const defaultLayoutBuilder = dimensions => {\r\n  const ids = R.keys(dimensions);\r\n  const timeId = R.find(rules.isTimeDimension)(ids);\r\n  const areaId = R.find(rules.isAreaDimension)(ids);\r\n  const helper = (omitIds, pickId) =>\r\n    R.pipe(\r\n      R.omit(omitIds),\r\n      R.ifElse(R.has(pickId), R.prop(pickId), R.pipe(R.values, R.head)),\r\n      R.prop('id'),\r\n    );\r\n  const x = helper([], areaId)(dimensions);\r\n  const y = helper([areaId, x], timeId)(dimensions);\r\n  const z = R.pipe(R.omit([x, y]), R.values, R.pluck('id'))(dimensions);\r\n\r\n  return {\r\n    rows: R.ifElse(R.isNil, R.always([]), R.flip(R.append)([]))(x),\r\n    header: R.ifElse(R.isNil, R.always([]), R.flip(R.append)([]))(y),\r\n    sections: z,\r\n  };\r\n};\r\n\r\nexport const defaultConcat = (array1 = []) => (array2 = []) => R.concat(array2, array1);\r\nexport const deleteItem = (key, prop) =>\r\n  R.pipe(R.prop(key), R.filter(v => R.not(R.equals(v, prop))));\r\nexport const getValuesFlat = R.pipe(R.values, R.flatten);\r\n\r\nexport const adjustment = R.curry((notAvailableIds, layout) => {\r\n  const withoutNotAvailableIds = R.flip(R.difference)(notAvailableIds);\r\n  if (R.pipe(R.prop('rows'), withoutNotAvailableIds, R.isEmpty)(layout)) {\r\n    const pivot = R.pipe(R.prop('sections'), withoutNotAvailableIds, R.isEmpty)(layout)\r\n      ? 'header'\r\n      : 'sections';\r\n    const id = R.pipe(R.prop(pivot), withoutNotAvailableIds, R.head)(layout);\r\n    return R.pipe(R.assoc('rows', R.concat([id], R.propOr([], 'rows')(layout))), layout => ({\r\n      ...layout,\r\n      [pivot]: deleteItem(pivot, id)(layout),\r\n    }))(layout);\r\n  }\r\n  return layout;\r\n});\r\n\r\nexport const hasInvalidIds = layoutIds => R.pipe(R.flip(R.difference)(layoutIds), R.isEmpty, R.not);\r\nexport const isInvalid = (dimensionIds, layoutIds, layout) =>\r\n  R.or(hasInvalidIds(dimensionIds)(layoutIds), R.isEmpty(layout));\r\n\r\nexport const manyFormat = (format, timeDimensionInverted) =>\r\n  R.mapObjIndexed((dimension, id) => ({\r\n    id,\r\n    isTimePeriod: rules.isTimeDimension(id),\r\n    isTimeDimensionInverted: R.prop(id)(timeDimensionInverted),\r\n    label: format(dimension),\r\n    value: id,\r\n  }));\r\nexport const oneFormat = format =>\r\n  R.mapObjIndexed((dimension, id) => ({\r\n    id,\r\n    label: format(dimension),\r\n    value: id,\r\n    isOne: true,\r\n  }));\r\n\r\nexport const getDefaultLayout = (many, getMissingIds = []) => {\r\n  const defaultLayout = defaultLayoutBuilder(many);\r\n  const defaultMissingIds = R.pipe(getValuesFlat, getMissingIds)(defaultLayout);\r\n  return R.over(R.lensProp('sections'), defaultConcat(defaultMissingIds))(defaultLayout);\r\n};\r\nexport const getLayout = (missingIds, dimensionsIds) =>\r\n  R.pipe(R.over(R.lensProp('sections'), defaultConcat(missingIds)), adjustment(dimensionsIds));\r\n","import { createSelector } from 'reselect';\r\nimport * as R from 'ramda';\r\nimport { rules } from '@sis-cc/dotstatsuite-components';\r\nimport { getData, getLayout, getDimensions } from './sdmx';\r\nimport { getTimeDimensionInverted, getLayout as getVisLayout, getDimensionFormat } from './vis';\r\nimport { withIndex } from '../lib/utils';\r\nimport * as Layout from '../lib/layout';\r\nimport * as Sdmx from '../lib/sdmx';\r\n\r\nexport const getDataDimensions = () =>\r\n  createSelector(\r\n    getData,\r\n    R.pipe(\r\n      R.pathOr([], ['structure', 'dimensions', 'observation']),\r\n      R.addIndex(R.map)((dimension, index) =>\r\n        R.pipe(\r\n          R.assoc('index', index),\r\n          R.set(R.lensProp('values'), withIndex(R.propOr([], 'values')(dimension))),\r\n        )(dimension),\r\n      ),\r\n    ),\r\n  );\r\n\r\nexport const getVisDataDimensions = () =>\r\n  createSelector(\r\n    getDataDimensions(),\r\n    R.pipe(\r\n      R.partition(R.pipe(R.propOr([], 'values'), R.length, R.flip(R.gt)(1))),\r\n      R.converge(\r\n        (many, one) => ({\r\n          many: R.indexBy(R.prop('id'))(many),\r\n          one: R.indexBy(R.prop('id'))(one),\r\n        }),\r\n        [R.head, R.last],\r\n      ),\r\n    ),\r\n  );\r\n\r\nexport const getTableConfigDimensions = createSelector(\r\n  getVisDataDimensions(),\r\n  getDimensionFormat,\r\n  getTimeDimensionInverted,\r\n  ({ many, one }, format, timeDimensionInverted) =>\r\n    R.mergeRight(\r\n      Layout.oneFormat(format)(one),\r\n      Layout.manyFormat(format, timeDimensionInverted)(many),\r\n    ),\r\n);\r\n\r\nexport const getVisTableData = () =>\r\n  createSelector(getTimeDimensionInverted, getData, R.uncurryN(2, rules.getTableData));\r\n\r\nexport const getFlatDimensionsIds = () =>\r\n  createSelector(getDimensions, getDataDimensions(), (structureDimensions, dataDimensions) =>\r\n    R.useWith(Sdmx.getUniq, [Sdmx.getDimensionsIds, Sdmx.getDimensionsIds])(\r\n      structureDimensions,\r\n      dataDimensions,\r\n    ),\r\n  );\r\n\r\nexport const getVisTableConfigLayout = () =>\r\n  createSelector(\r\n    getVisLayout,\r\n    getLayout,\r\n    getFlatDimensionsIds(),\r\n    getVisDataDimensions(),\r\n    (visLayout = {}, sdmxLayout = {}, dimensionsIds, { many, one }) => {\r\n      const layout = R.pipe(\r\n        R.ifElse(R.isEmpty, R.always(sdmxLayout), R.identity),\r\n        R.mergeRight({ sections: [], rows: [], header: [] }),\r\n      )(visLayout);\r\n      const getMissingIds = R.difference(dimensionsIds);\r\n      const oneIds = R.keys(one);\r\n      const layoutIds = Layout.getValuesFlat(layout);\r\n\r\n      if (Layout.isInvalid(dimensionsIds, layoutIds, layout))\r\n        return Layout.getDefaultLayout(many, getMissingIds);\r\n\r\n      const missingIds = getMissingIds(layoutIds);\r\n      if (R.isEmpty(missingIds)) return Layout.adjustment(oneIds, layout);\r\n\r\n      return Layout.getLayout(missingIds, oneIds)(layout);\r\n    },\r\n  );\r\n\r\nexport const getVisTableLayout = () =>\r\n  createSelector(getVisTableConfigLayout(), getVisDataDimensions(), (layout, { many }) => {\r\n    const idsNotInMany = R.difference(Layout.getValuesFlat(layout), R.keys(many));\r\n    return R.map(R.flip(R.difference)(idsNotInMany))(layout);\r\n  });\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { DETableConfig, VXFilterContainer } from '@sis-cc/dotstatsuite-ui-components';\r\n\r\nconst TableConfig = ({ title, ...tableProps }) => (\r\n  <VXFilterContainer titleLabel={title} noCollapse noScroll>\r\n    <DETableConfig {...tableProps} />\r\n  </VXFilterContainer>\r\n);\r\n\r\nTableConfig.propTypes = {\r\n  title: PropTypes.object,\r\n};\r\n\r\nexport default TableConfig;\r\n","import React from 'react';\r\nimport * as R from 'ramda';\r\nimport { connect } from 'react-redux';\r\nimport { createStructuredSelector } from 'reselect';\r\nimport { compose, withProps } from 'recompose';\r\nimport { FormattedMessage, injectIntl } from 'react-intl';\r\nimport { getDimensionGetter } from '../../selectors/vis';\r\nimport { getTableConfigDimensions, getVisTableConfigLayout } from '../../selectors/table';\r\nimport {\r\n  changeLayout,\r\n  changeDimensionGetter,\r\n  changeIsTimeDimensionInverted,\r\n} from '../../ducks/vis';\r\nimport { dimensionFormats } from '../../lib/utils';\r\nimport TableConfig from './TableConfig';\r\n\r\nexport default compose(\r\n  connect(\r\n    createStructuredSelector({\r\n      dimensions: getTableConfigDimensions,\r\n      dimensionGetter: getDimensionGetter,\r\n      layout: getVisTableConfigLayout(),\r\n    }),\r\n    { changeLayout, changeGetter: changeDimensionGetter, changeIsTimeDimensionInverted },\r\n  ),\r\n  injectIntl,\r\n  withProps(({ intl }) => ({\r\n    isNarrow: true,\r\n    noPreview: true,\r\n    title: <FormattedMessage id=\"de.table.layout.title\" />,\r\n    labels: {\r\n      commit: <FormattedMessage id=\"de.table.layout.apply\" />,\r\n      cancel: <FormattedMessage id=\"de.table.layout.cancel\" />,\r\n      row: <FormattedMessage id=\"de.table.layout.x\" />,\r\n      column: <FormattedMessage id=\"de.table.layout.y\" />,\r\n      section: <FormattedMessage id=\"de.table.layout.z\" />,\r\n      d: <FormattedMessage id=\"de.table.layout.getter.dimension\" />,\r\n      o: <FormattedMessage id=\"de.table.layout.getter.observation\" />,\r\n      time: <FormattedMessage id=\"de.table.layout.time\" />,\r\n      asc: <FormattedMessage id=\"de.table.layout.time.asc\" />,\r\n      desc: <FormattedMessage id=\"de.table.layout.time.desc\" />,\r\n      help: <FormattedMessage id=\"de.table.layout.help\" />,\r\n      table: <FormattedMessage id=\"de.table.layout.table\" />,\r\n      one: <FormattedMessage id=\"de.table.layout.value.one\" />,\r\n    },\r\n    dimensionGetters: R.reduce(\r\n      (memo, key) => ({ ...memo, [key]: intl.formatMessage({ id: `vx.config.display.${key}` }) }),\r\n      {},\r\n      R.keys(dimensionFormats),\r\n    ),\r\n  })),\r\n)(TableConfig);\r\n","import React from 'react';\r\nimport { FormattedMessage } from 'react-intl';\r\n\r\n//temp disable the charts\r\n\r\nexport default [\r\n  /*\r\n  {\r\n    label: <FormattedMessage id=\"de.visualisation.toolbar.table\" />,\r\n    id: 'table',\r\n  },\r\n  {\r\n    label: <FormattedMessage id=\"de.visualisation.toolbar.chart\" />,\r\n    id: 'chart',\r\n    children: [\r\n      {\r\n        icon: 'timeline-line-chart',\r\n        label: <FormattedMessage id=\"de.visualisation.toolbar.chart.timeline\" />,\r\n        id: 'TimelineChart',\r\n      },\r\n      {\r\n        icon: 'timeline-bar-chart',\r\n        id: 'BarChart',\r\n        label: <FormattedMessage id=\"de.visualisation.toolbar.chart.bar\" />,\r\n      },\r\n      {\r\n        icon: 'horizontal-bar-chart',\r\n        id: 'RowChart',\r\n        label: <FormattedMessage id=\"de.visualisation.toolbar.chart.row\" />,\r\n      },\r\n      /*{\r\n        icon: 'stacked-chart',\r\n        label: <FormattedMessage id=\"de.visualisation.toolbar.chart.stacked\" />,\r\n        id: 'StackedBarChart',\r\n      },*/\r\n  /*],\r\n  },*/\r\n];\r\n","import React from 'react';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport * as R from 'ramda';\r\n\r\nexport default ({ changeActionId, requestDataFile, dataflow, isFullscreen, isNarrow }) => {\r\n  const actions = [\r\n    /*{\r\n      icon: 'cog',\r\n      id: 'config',\r\n      label: <FormattedMessage id=\"de.visualisation.toolbar.action.customize\" />,\r\n      action: () => changeActionId('config'),\r\n    },*/\r\n    {\r\n      icon: 'import',\r\n      id: 'download',\r\n      label: <FormattedMessage id=\"de.visualisation.toolbar.action.download\" />,\r\n      children: [\r\n        {\r\n          id: 'csv-selection',\r\n          label: <FormattedMessage id=\"de.visualisation.toolbar.action.download.csv.selection\" />,\r\n          action: () => requestDataFile({ dataflow }),\r\n        },\r\n        {\r\n          id: 'csv-full',\r\n          label: <FormattedMessage id=\"de.visualisation.toolbar.action.download.csv.all\" />,\r\n          action: () => requestDataFile({ isDownloadAllData: true, dataflow }),\r\n        },\r\n      ],\r\n    },\r\n    {\r\n      icon: isFullscreen ? 'minimize' : 'maximize',\r\n      id: 'fullscreen',\r\n      label: <FormattedMessage id=\"de.visualisation.toolbar.action.fullscreen\" />,\r\n      action: () => changeActionId('fullscreen'),\r\n    },\r\n  ];\r\n\r\n  const filtersBtn = {\r\n    icon: 'filter-list',\r\n    id: 'filters',\r\n    label: <FormattedMessage id=\"de.side.filters.action\" />,\r\n    action: () => changeActionId('filters'),\r\n  };\r\n\r\n  return R.pipe(R.ifElse(R.always(isNarrow), R.prepend(filtersBtn), R.identity))(actions);\r\n};\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { createStructuredSelector } from 'reselect';\r\nimport { compose, withProps } from 'recompose';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport { DEVisualisationToolbar } from '@sis-cc/dotstatsuite-ui-components';\r\nimport { getIsPending } from '../../selectors/app';\r\nimport { getDataflow } from '../../selectors/vis';\r\nimport { changeViewer, changeAction } from '../../ducks/vis';\r\nimport { requestDataFile } from '../../ducks/sdmx';\r\nimport menus from './menus';\r\nimport actions from './actions';\r\n\r\nexport default compose(\r\n  connect(\r\n    createStructuredSelector({\r\n      isDownloading: getIsPending('requestingDataFile'),\r\n      dataflow: getDataflow,\r\n    }),\r\n    { changeMenu: changeViewer, changeActionId: changeAction, requestDataFile },\r\n  ),\r\n  withProps(({ isDownloading, viewerId, actionId, ...rest }) => ({\r\n    loadingActionId: isDownloading ? 'download' : null,\r\n    selectedMenuId: viewerId,\r\n    selectedActionId: actionId,\r\n    actions: actions({ ...rest, viewerId }),\r\n    menus,\r\n    showLabel: <FormattedMessage id=\"de.visualisation.toolbar.show\" />,\r\n  })),\r\n)(DEVisualisationToolbar);\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { VXFilterContainer } from '@sis-cc/dotstatsuite-ui-components';\r\nimport FilterPeriod from '../FilterPeriod';\r\nimport FilterSelection from '../FilterSelection';\r\nimport Filters from '../Filters';\r\nimport Toolbar from '../Toolbar';\r\nimport TableConfig from '../TableConfig';\r\n\r\nconst Tools = ({\r\n  isNarrow,\r\n  isRtl,\r\n  isFullscreen,\r\n  actionId,\r\n  /*isChartConfig,*/\r\n  isFilters,\r\n}) => (\r\n  <React.Fragment>\r\n    <Toolbar isNarrow={isNarrow} isRtl={isRtl} isFull={isFullscreen} actionId={actionId} />\r\n    {/*<VXFilterContainer isOpen={isChartConfig} noScroll noHeader>\r\n      <ChartConfig properties={properties} />\r\n    </VXFilterContainer>*/}\r\n    {isNarrow && (\r\n      <VXFilterContainer isOpen={isFilters} noScroll noHeader>\r\n        <FilterSelection isNarrow={isNarrow} isRtl={isRtl} />\r\n        <FilterPeriod isNarrow={isNarrow} isRtl={isRtl} />\r\n        <Filters isNarrow={isNarrow} isRtl={isRtl} />\r\n        <TableConfig isNarrow={isNarrow} isRtl={isRtl} />\r\n      </VXFilterContainer>\r\n    )}\r\n  </React.Fragment>\r\n);\r\n\r\nTools.propTypes = {\r\n  isNarrow: PropTypes.bool,\r\n  isRtl: PropTypes.bool,\r\n  isFullscreen: PropTypes.bool,\r\n  isChartConfig: PropTypes.bool,\r\n  isFilters: PropTypes.bool,\r\n  actionId: PropTypes.string,\r\n};\r\n\r\nexport default Tools;\r\n","import { connect } from 'react-redux';\r\nimport { createStructuredSelector } from 'reselect';\r\nimport { compose, withProps } from 'recompose';\r\nimport * as R from 'ramda';\r\nimport { getViewer, getAction } from '../../selectors/vis';\r\nimport Tools from './Tools';\r\n\r\nexport default compose(\r\n  connect(\r\n    createStructuredSelector({\r\n      actionId: getAction,\r\n      viewerId: getViewer,\r\n    }),\r\n  ),\r\n  withProps(({ actionId, viewerId }) => ({\r\n    isChartConfig: R.equals('config', actionId) && !R.equals('table', viewerId),\r\n    isFilters: R.equals('filters', actionId),\r\n  })),\r\n)(Tools);\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { DETableCell } from '@sis-cc/dotstatsuite-ui-components';\r\nimport glamorous from 'glamorous';\r\n\r\nconst StyledCell = glamorous.div(\r\n  {\r\n    width: '100%',\r\n    height: '100%',\r\n    padding: '4px 6px',\r\n    fontSize: 16,\r\n    textAlign: 'right',\r\n  },\r\n  ({ isYLast, isXLast, theme }) => ({\r\n    color: theme.table.oFont,\r\n    borderTop: `1px solid ${theme.table.border}`,\r\n    borderLeft: `1px solid ${theme.table.border}`,\r\n    borderRight: isYLast ? `1px solid ${theme.table.border}` : null,\r\n    borderBottom: isXLast ? null : `1px solid ${theme.table.border}`,\r\n    backgroundColor: theme.table.xBg,\r\n  }),\r\n);\r\n\r\nconst Cell = ({ renderObservation, variant }) => (\r\n  <React.Fragment>\r\n    <StyledCell isXLast isYLast>\r\n      <DETableCell value=\"Value\" variant={variant} />\r\n    </StyledCell>\r\n    <StyledCell isYLast>{renderObservation()}</StyledCell>\r\n  </React.Fragment>\r\n);\r\n\r\nCell.propTypes = {\r\n  renderObservation: PropTypes.func,\r\n  variant: PropTypes.string,\r\n};\r\n\r\nexport default Cell;\r\n","import React from 'react';\r\nimport { FormattedMessage } from 'react-intl';\r\n\r\n//temp disable the charts\r\n\r\nexport default [\r\n  /*\r\n  {\r\n    label: <FormattedMessage id=\"de.visualisation.toolbar.table\" />,\r\n    id: 'table',\r\n  },\r\n  {\r\n    label: <FormattedMessage id=\"de.visualisation.toolbar.chart\" />,\r\n    id: 'chart',\r\n    children: [\r\n      {\r\n        icon: 'timeline-line-chart',\r\n        label: <FormattedMessage id=\"de.visualisation.toolbar.chart.timeline\" />,\r\n        id: 'TimelineChart',\r\n      },\r\n      {\r\n        icon: 'timeline-bar-chart',\r\n        id: 'BarChart',\r\n        label: <FormattedMessage id=\"de.visualisation.toolbar.chart.bar\" />,\r\n      },\r\n      {\r\n        icon: 'horizontal-bar-chart',\r\n        id: 'RowChart',\r\n        label: <FormattedMessage id=\"de.visualisation.toolbar.chart.row\" />,\r\n      },\r\n      /*{\r\n        icon: 'stacked-chart',\r\n        label: <FormattedMessage id=\"de.visualisation.toolbar.chart.stacked\" />,\r\n        id: 'StackedBarChart',\r\n      },*/\r\n  /*],\r\n  },*/\r\n];\r\n","import React from 'react';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport * as R from 'ramda';\r\n\r\nexport default ({ requestDataFile, dataflow }) => {\r\n  const actions = [\r\n    {\r\n      icon: 'import',\r\n      id: 'download',\r\n      label: <FormattedMessage id=\"de.visualisation.toolbar.action.download\" />,\r\n      children: [\r\n        {\r\n          id: 'csv-selection',\r\n          label: <FormattedMessage id=\"de.visualisation.toolbar.action.download.csv.selection\" />,\r\n          action: () => requestDataFile({ dataflow }),\r\n        },\r\n        {\r\n          id: 'csv-full',\r\n          label: <FormattedMessage id=\"de.visualisation.toolbar.action.download.csv.all\" />,\r\n          action: () => requestDataFile({ isDownloadAllData: true, dataflow }),\r\n        },\r\n      ],\r\n    },\r\n  ];\r\n\r\n  return actions;\r\n};\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { createStructuredSelector } from 'reselect';\r\nimport { compose, withProps } from 'recompose';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport { DEVisualisationToolbar } from '@sis-cc/dotstatsuite-ui-components';\r\nimport { getIsPending } from '../../selectors/app';\r\nimport { getDataflow, getAction, getViewer } from '../../selectors/vis';\r\nimport { changeViewer, changeAction } from '../../ducks/vis';\r\nimport { requestDataFile } from '../../ducks/sdmx';\r\nimport menus from './menus';\r\nimport actions from './actions';\r\nimport * as R from 'ramda';\r\n\r\n\r\nexport default compose(\r\n  connect(\r\n    createStructuredSelector({\r\n      isDownloading: getIsPending('requestingDataFile'),\r\n      dataflow: getDataflow,\r\n      actionId:getAction,\r\n      viewerId:getViewer,\r\n    }),\r\n    { changeMenu: changeViewer, changeActionId: changeAction, requestDataFile },\r\n  ),\r\n  withProps(({ isDownloading, viewerId, actionId, ...rest }) => ({\r\n    loadingActionId: isDownloading ? 'download' : null,\r\n    selectedMenuId: viewerId,\r\n    selectedActionId: actionId,\r\n    actions: actions({ ...rest, viewerId }),\r\n    menus,\r\n    showLabel: <FormattedMessage id=\"de.visualisation.toolbar.show\" />,\r\n    isFilters:R.equals('filters', actionId),\r\n  })),\r\n)(DEVisualisationToolbar);\r\n\r\n/*\r\nexport default compose(\r\n  connect(\r\n    createStructuredSelector({\r\n      isDownloading: getIsPending('requestingDataFile'),\r\n      dataflow: getDataflow,\r\n      actionId:getAction,\r\n      viewerId:getViewer,\r\n    }),\r\n    { changeMenu: changeViewer, changeActionId: changeAction, requestDataFile },\r\n  ),\r\n  withProps(({ isDownloading, viewerId, actionId, ...rest }) => ({\r\n    loadingActionId: isDownloading ? 'download' : null,\r\n    selectedMenuId: viewerId,\r\n    selectedActionId: actionId,\r\n    actions: actions({ ...rest, viewerId }),\r\n    menus,\r\n    showLabel: <FormattedMessage id=\"de.visualisation.toolbar.show\" />,\r\n    isFilters:R.equals('filters', actionId),\r\n  })),\r\n)(DEVisualisationToolbar);*/","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { SDMXTable } from '@sis-cc/dotstatsuite-ui-components';\r\nimport SisHeader from '@sis-cc/dotstatsuite-ui-header';\r\nimport SisFooter from '@sis-cc/dotstatsuite-ui-footer';\r\nimport glamorous from 'glamorous';\r\nimport Cell from './Cell';\r\n//import Tools from '../Tools';\r\nimport Toolbar from '../ToolbarUnicef';\r\n\r\nconst TableContainer = glamorous.div({\r\n  borderLeftWidth: 0,\r\n  borderRightWidth: 0,\r\n  marginTop: 10, // sync style with chart\r\n\r\n  overflowX: 'auto',\r\n});\r\n\r\nconst Table = ({\r\n  header,\r\n  viewerConfig,\r\n  data,\r\n  layoutIds,\r\n  renderObservation,\r\n  itemFormatter,\r\n  isNotATable,\r\n  footnotes,\r\n  variant,\r\n}) => (\r\n    <TableContainer>\r\n      {/* <div>Message</div> */}\r\n      <div className=\"header_download\">\r\n        <SisHeader {...header} fonts={viewerConfig.fonts.header} />\r\n        <Toolbar />\r\n      </div>\r\n      {isNotATable ? (\r\n        <Cell renderObservation={renderObservation} variant={variant} />\r\n      ) : (\r\n          <SDMXTable\r\n            data={data}\r\n            layoutIds={layoutIds}\r\n            renderObservation={renderObservation}\r\n            itemFormatter={itemFormatter}\r\n          />\r\n        )}\r\n      <SisFooter\r\n        {...viewerConfig}\r\n        fonts={viewerConfig.fonts.footer}\r\n        source={\r\n          viewerConfig.footer_visible\r\n            ? { link: footnotes.source, label: footnotes.sourceLabel }\r\n            : { link: ' ', label: ' ' }\r\n        }\r\n      />\r\n    </TableContainer>\r\n  );\r\n\r\nTable.propTypes = {\r\n  header: PropTypes.object,\r\n  viewerConfig: PropTypes.object,\r\n  source: PropTypes.object,\r\n  data: PropTypes.object,\r\n  footnotes: PropTypes.object,\r\n  layoutIds: PropTypes.object,\r\n  renderObservation: PropTypes.func,\r\n  itemFormatter: PropTypes.func,\r\n  isNotATable: PropTypes.bool,\r\n  variant: PropTypes.string,\r\n};\r\n\r\nexport default Table;\r\n","import * as R from 'ramda';\r\nimport { connect } from 'react-redux';\r\nimport { createStructuredSelector } from 'reselect';\r\nimport { compose, mapProps } from 'recompose';\r\nimport { getVisDataDimensions, getVisTableLayout, getVisTableData } from '../../selectors/table';\r\nimport { getDimensionFormat, getDimensionGetter } from '../../selectors/vis';\r\nimport { getCustomAttributes } from '../../selectors/sdmx';\r\nimport { rules } from '@sis-cc/dotstatsuite-components';\r\nimport { DETableCell } from '@sis-cc/dotstatsuite-ui-components';\r\nimport Table from './Table';\r\n\r\nconst Cell = connect(createStructuredSelector({ variant: getDimensionGetter }))(DETableCell);\r\n\r\nexport default compose(\r\n  connect(\r\n    createStructuredSelector({\r\n      dimensions: getVisDataDimensions(),\r\n      customAttributes: getCustomAttributes,\r\n      layoutIds: getVisTableLayout(),\r\n      itemFormatter: getDimensionFormat,\r\n      data: getVisTableData(),\r\n      variant: getDimensionGetter,\r\n    }),\r\n  ),\r\n  mapProps(\r\n    ({\r\n      chartData,\r\n      viewerConfig,\r\n      data,\r\n      customAttributes,\r\n      dimensions,\r\n      layoutIds,\r\n      itemFormatter,\r\n      variant,\r\n    }) => ({\r\n      viewerConfig,\r\n      data,\r\n      layoutIds,\r\n      itemFormatter,\r\n      renderObservation: rules.observationGetter(Cell)({\r\n        observations: R.prop('observations', data),\r\n        dimensions,\r\n        customAttributes,\r\n        isRtl: false,\r\n      })(R.identity),\r\n      // little dirty for now, in the wait of a better common mgmt of table and charts\r\n      header: R.pick(['title', 'subtitle', 'uprs'], chartData),\r\n      footnotes: R.prop('footnotes', chartData),\r\n      isNotATable: R.pipe(R.prop('observations'), R.values, R.length, R.equals(1))(data),\r\n      variant,\r\n    }),\r\n  ),\r\n)(Table);\r\n","import { Chart } from '@sis-cc/dotstatsuite-components';\r\nimport { mapProps } from 'recompose';\r\n\r\nexport default mapProps(({ chartData, chartOptions, viewerConfig, type }) => ({\r\n  data: chartData,\r\n  options: chartOptions,\r\n  config: viewerConfig,\r\n  type,\r\n}))(Chart);\r\n","const fonts = { fontFamily: 'Segoe UI' };\r\n\r\nexport default {\r\n  owner: 'UNICEF',\r\n  logo: '',\r\n  footer_visible: false,\r\n  fonts: {\r\n    header: { subtitle: fonts, title: fonts, uprs: fonts, tooltip: fonts },\r\n    chart: {\r\n      axisLegend: fonts,\r\n      chartLegend: fonts,\r\n      tooltip: { primary: fonts, secondary: fonts },\r\n    },\r\n    footer: { copyright: fonts, source: fonts },\r\n  },\r\n};\r\n","import React from 'react';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport { connect } from 'react-redux';\r\nimport { createStructuredSelector } from 'reselect';\r\nimport { compose, branch, renderComponent, withProps } from 'recompose';\r\nimport * as R from 'ramda';\r\nimport { VXNoData } from '@sis-cc/dotstatsuite-ui-components';\r\nimport { getViewer } from '../../selectors/vis';\r\nimport Table from '../Table';\r\nimport Chart from '../Chart';\r\nimport viewerConfig from './config';\r\n\r\nexport default compose(\r\n  connect(createStructuredSelector({ type: getViewer })),\r\n  withProps({ viewerConfig }),\r\n  branch(\r\n    R.pipe(R.prop('data'), R.isNil),\r\n    renderComponent(() => <VXNoData message={<FormattedMessage id=\"vx.no.data\" />} />),\r\n  ),\r\n  branch(({ type }) => R.equals(type, 'table'), renderComponent(Table)),\r\n)(Chart);\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport * as R from 'ramda';\r\nimport { VXFilterContainerCollapsible } from '@sis-cc/dotstatsuite-ui-components';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport { FormattedMessage } from 'react-intl';\r\n\r\nconst Footnotes = ({ footnotes }) => (\r\n  <VXFilterContainerCollapsible\r\n    titleLabel={<FormattedMessage id=\"footnotes\" />}\r\n    isOpen={false}\r\n    noScroll\r\n  >\r\n    <List dense>\r\n      {R.map(({ id, name, values }) => (\r\n        <ListItem key={id}>\r\n          <ListItemText\r\n            primary={R.defaultTo(id, name)}\r\n            secondary={R.pipe(R.pluck('name'), R.join(' | '))(values)}\r\n          />\r\n        </ListItem>\r\n      ))(footnotes)}\r\n    </List>\r\n  </VXFilterContainerCollapsible>\r\n);\r\n\r\nFootnotes.propTypes = {\r\n  footnotes: PropTypes.array,\r\n};\r\n\r\nexport default Footnotes;\r\n","import * as R from 'ramda';\r\nimport { connect } from 'react-redux';\r\nimport { createStructuredSelector } from 'reselect';\r\nimport { compose, mapProps } from 'recompose';\r\nimport { getCustomAttributes } from '../../selectors/sdmx';\r\nimport Footnotes from './Footnotes';\r\n\r\nexport default compose(\r\n  connect(\r\n    createStructuredSelector({\r\n      attributes: getCustomAttributes,\r\n    }),\r\n  ),\r\n  mapProps(\r\n    R.pipe(\r\n      R.prop('attributes'),\r\n      R.pick(['footnotes']),\r\n      R.prop('footnotes'),\r\n      R.reject(\r\n        R.pipe(\r\n          R.prop('id'),\r\n          R.flip(R.includes)(['UNIT_MEASURE']), // UNICEF specific\r\n        ),\r\n      ),\r\n      R.assoc('footnotes', R.__, {}),\r\n    ),\r\n  ),\r\n)(Footnotes);\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport { VXLoader } from '@sis-cc/dotstatsuite-ui-components';\r\nimport { RulesDriver } from '@sis-cc/dotstatsuite-components';\r\nimport Tools from '../Tools';\r\nimport Viewer from '../Viewer';\r\nimport Footnotes from '../Footnotes';\r\n\r\nconst Main = ({\r\n  data,\r\n  enhancedData,\r\n  isRtl,\r\n  isNarrow,\r\n  isFullscreen,\r\n  isLoadingData,\r\n  display,\r\n  formaterIds,\r\n  type,\r\n  options,\r\n  dataUrl,\r\n}) => (\r\n  <RulesDriver\r\n    data={enhancedData}\r\n    display={display}\r\n    formaterIds={formaterIds}\r\n    type={type}\r\n    options={options}\r\n    sdmxUrl={dataUrl}\r\n    source={{ link: window.location.href }}\r\n    render={({ chartData, chartOptions, properties }) => (\r\n      <div>\r\n        {/* <Tools\r\n          isNarrow={isNarrow}\r\n          isRtl={isRtl}\r\n          isFullscreen={isFullscreen}\r\n          properties={properties}\r\n        /> */}\r\n        {isLoadingData && (\r\n          <VXLoader\r\n            isNarrow={isNarrow}\r\n            isRtl={isRtl}\r\n            loadingLabel={<FormattedMessage id=\"de.visualisation.data.loading\" />}\r\n            isLarge\r\n          />\r\n        )}\r\n        {!isLoadingData && (\r\n          <React.Fragment>\r\n            <Viewer\r\n              chartData={chartData}\r\n              chartOptions={chartOptions}\r\n              data={data}\r\n              isNarrow={isNarrow}\r\n              isRtl={isRtl}\r\n            />\r\n            <br />\r\n            <Footnotes />\r\n          </React.Fragment>\r\n        )}\r\n      </div>\r\n    )}\r\n  />\r\n);\r\n\r\nMain.propTypes = {\r\n  data: PropTypes.object,\r\n  enhancedData: PropTypes.object,\r\n  display: PropTypes.string,\r\n  formaterIds: PropTypes.object,\r\n  type: PropTypes.string,\r\n  options: PropTypes.object,\r\n  dataUrl: PropTypes.string,\r\n  isNarrow: PropTypes.bool,\r\n  isRtl: PropTypes.bool,\r\n  isLoadingData: PropTypes.bool,\r\n  isFullscreen: PropTypes.bool,\r\n};\r\n\r\nexport default Main;\r\n","import * as R from 'ramda';\r\nimport { connect } from 'react-redux';\r\nimport { createStructuredSelector } from 'reselect';\r\nimport { compose, withProps } from 'recompose';\r\nimport { getData } from '../../selectors/sdmx';\r\nimport { getLocale, getIsPending } from '../../selectors/app';\r\nimport { getDisplay, getPeriod, getDataquery, getDataflow, getViewer } from '../../selectors/vis';\r\nimport { getDataUrl } from '../../lib/sdmx';\r\nimport { getSdmxAttribute, chartOptions } from '../../lib/settings';\r\nimport Main from './Main';\r\n\r\nexport default compose(\r\n  connect(\r\n    createStructuredSelector({\r\n      isLoadingData: getIsPending('getData'),\r\n      display: getDisplay,\r\n      type: getViewer,\r\n      data: getData,\r\n      dataflow: getDataflow,\r\n      dataquery: getDataquery,\r\n      locale: getLocale,\r\n      period: getPeriod,\r\n    }),\r\n  ),\r\n  withProps(({ data, dataflow, dataquery, locale, period }) => ({\r\n    dataUrl: getDataUrl({ configArgs: { dataflow, dataquery, locale }, requestArgs: { period } }),\r\n    options: chartOptions,\r\n    formaterIds: {\r\n      decimals: getSdmxAttribute('decimals'),\r\n      prefscale: getSdmxAttribute('prefscale'),\r\n    },\r\n    enhancedData: data,\r\n  })),\r\n)(Main);\r\n\r\n/*\r\nexport default compose(\r\n  connect(\r\n    createStructuredSelector({\r\n      isLoadingData: getIsPending('getData'),\r\n      display: getDisplay,\r\n      type: getViewer,\r\n      data: getData,\r\n      dataflow: getDataflow,\r\n      dataquery: getDataquery,\r\n      locale: getLocale,\r\n      period: getPeriod,\r\n    }),\r\n  ),\r\n  withProps(({ data, dataflow, dataquery, locale, period }) => ({\r\n    dataUrl: getDataUrl({ configArgs: { dataflow, dataquery, locale }, requestArgs: { period } }),\r\n    options: chartOptions,\r\n    formaterIds: {\r\n      decimals: getSdmxAttribute('decimals'),\r\n      prefscale: getSdmxAttribute('prefscale'),\r\n    },\r\n    enhancedData: R.over(\r\n      R.lensPath(['structure', 'dimensions', 'observation']),\r\n      //R.append({ id: 'FREQ', values: [{ id: 'A' }] }), is this hardcoded?\r\n      R.append({ id: 'Frequency', values: [{ id: 'Annual' }] }),\r\n      data,\r\n    ),\r\n  })),\r\n)(Main);\r\n*/\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport {\r\n  DELayout,\r\n  DELayoutContent,\r\n  DELayoutSide,\r\n  DELayoutMain,\r\n  VXLoader,\r\n} from '@sis-cc/dotstatsuite-ui-components';\r\nimport FilterPeriod from '../FilterPeriod';\r\nimport FilterSelection from '../FilterSelection';\r\nimport Filters from '../Filters';\r\nimport TableConfig from '../TableConfig';\r\nimport Main from '../Main';\r\n\r\nconst App = ({ isNarrow, isRtl, isLoadingStructure, isLoadingData, isFullscreen }) => (\r\n  <DELayout isNarrow={isNarrow} isRtl={isRtl} isFull={isFullscreen}>\r\n    <DELayoutContent>\r\n      {isLoadingStructure && (\r\n        <VXLoader\r\n          isNarrow={isNarrow}\r\n          isRtl={isRtl}\r\n          loadingLabel={<FormattedMessage id=\"de.visualisation.loading\" />}\r\n          isLarge\r\n        />\r\n      )}\r\n    </DELayoutContent>\r\n    {!(isLoadingStructure || isNarrow) && (\r\n      <DELayoutSide>\r\n        <FilterPeriod isNarrow={isNarrow} isRtl={isRtl} />\r\n        <FilterSelection isNarrow={isNarrow} isRtl={isRtl} />\r\n        <Filters isNarrow={isNarrow} isRtl={isRtl} />\r\n        <div className=\"TableConfig_wrapper\">{!isLoadingData && <TableConfig isRtl={isRtl} />}</div>\r\n      </DELayoutSide>\r\n    )}\r\n    {!isLoadingStructure && (\r\n      <DELayoutMain>\r\n        <Main isNarrow={isNarrow} isRtl={isRtl} isFullscreen={isFullscreen} />\r\n      </DELayoutMain>\r\n    )}\r\n  </DELayout>\r\n);\r\n\r\nApp.propTypes = {\r\n  isNarrow: PropTypes.bool,\r\n  isRtl: PropTypes.bool,\r\n  isLoadingStructure: PropTypes.bool,\r\n  isLoadingData: PropTypes.bool,\r\n  isFullscreen: PropTypes.bool,\r\n};\r\n\r\nexport default App;\r\n","import * as R from 'ramda';\r\nimport { connect } from 'react-redux';\r\nimport { createStructuredSelector } from 'reselect';\r\nimport { compose, branch, renderNothing } from 'recompose';\r\nimport { getIsPending, getIsRtl } from '../../selectors/app';\r\nimport { getIsFullscreen, getDataflow } from '../../selectors/vis';\r\nimport withResponsiveness from '../../hocs/withResponsiveness';\r\nimport App from './App';\r\n\r\nexport default compose(\r\n  withResponsiveness,\r\n  connect(\r\n    createStructuredSelector({\r\n      isLoadingStructure: getIsPending('getStructure'),\r\n      isLoadingData: getIsPending('getData'),\r\n      isRtl: getIsRtl,\r\n      isFullscreen: getIsFullscreen,\r\n      dataflow: getDataflow,\r\n    }),\r\n  ),\r\n  branch(R.pipe(R.prop('dataflow'), R.isNil), renderNothing),\r\n)(App);\r\n","import React from 'react';\r\nimport { render } from 'react-dom';\r\nimport { Provider } from 'react-redux';\r\nimport '@blueprintjs/core/dist/blueprint.css';\r\nimport { I18nProvider, initialize as initializeI18n } from './i18n';\r\nimport { createStore, reducer } from './core';\r\nimport ThemeProvider from './theme';\r\nimport ErrorBoundary from './components/Error';\r\nimport App from './components/App';\r\nimport { changeDataflow } from './ducks/vis';\r\nimport './index.css';\r\nimport meta from '../../package.json';\r\n\r\nvar ES6_Error = false;\r\nif (!(typeof window.ES6_Error === 'undefined')) {\r\n  ES6_Error = window.ES6_Error;\r\n}\r\nif (ES6_Error) {\r\n  throw new Error('Browser not Supported');\r\n}\r\n\r\nconsole.info(`${meta.name}@${meta.version}`); // eslint-disable-line no-console\r\n\r\ninitializeI18n(window.SETTINGS.i18n);\r\nconst locale = window.SETTINGS.i18n.locales[window.SETTINGS.i18n.localeId];\r\n\r\nconst initialState = {\r\n  app: {\r\n    logs: [],\r\n    pending: {},\r\n    locale,\r\n  },\r\n  vis: {\r\n    filter: undefined, // id of the expanded filter: ''\r\n    viewer: 'table', // id of the viewer element to display\r\n    action: undefined, // id of the current tool action: ''\r\n    period: undefined, // period: [start, end]\r\n    dataflow: undefined, // dataflow identifiers: {datasourceId, dataflowId, agencyId, version}\r\n    isFullscreen: false, // fullscreen mode\r\n    dataquery: undefined, // dataquery: ''\r\n    display: 'label', // sdmx display mode: '' in label, code, both\r\n    timeDimensionInverted: {}, // sdmx time direction: obj of bools, true asc - false desc\r\n    layout: undefined, // layout of the table\r\n    dimensionGetter: 'label', // accessor of the dimension for labelling\r\n  },\r\n  sdmx: {\r\n    dimensions: [],\r\n    data: undefined,\r\n    layout: {},\r\n  },\r\n};\r\nconst store = createStore(initialState, reducer);\r\n\r\nconsole.log('initialized with DATAFLOW:', window.DATAFLOW); // eslint-disable-line no-console\r\nstore.dispatch(changeDataflow(window.DATAFLOW));\r\n\r\nconst ROOT = document.getElementById('root');\r\nROOT.addEventListener('unicef_changeDataflow', event =>\r\n  store.dispatch(changeDataflow(event.detail)),\r\n);\r\nconsole.log(`listen unicef_changeDataflow event`); // eslint-disable-line no-console\r\n\r\nrender(\r\n  <ErrorBoundary isFinal>\r\n    <Provider store={store}>\r\n      <ThemeProvider theme={{}} isRtl={locale.isRtl}>\r\n        <I18nProvider localeId={locale.id} messages={window.I18N}>\r\n          <ErrorBoundary>\r\n            <App />\r\n          </ErrorBoundary>\r\n        </I18nProvider>\r\n      </ThemeProvider>\r\n    </Provider>\r\n  </ErrorBoundary>,\r\n  ROOT,\r\n);\r\n","module.exports = __webpack_public_path__ + \"static/media/data-explorer-logo.707f6ef1.png\";"],"sourceRoot":""}